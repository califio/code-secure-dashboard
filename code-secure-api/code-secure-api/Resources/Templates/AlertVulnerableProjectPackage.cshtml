@using CodeSecure.Application
@using CodeSecure.Core.Enum
@model CodeSecure.Application.Module.Integration.AlertVulnerableProjectPackageModel
<div width="100%" style="margin:0;background-color:#f6f7fb; font-family: Helvetica, sans-serif, 'Times New Roman'">
    <div style="padding:0;overflow:hidden;width:100%;max-width:100%">
        <table role="presentation" cellspacing="0" cellpadding="0"
               border="0" align="center" width="100%" style="margin:auto">
            <tbody>
            <tr>
                <td align="center" valign="top">
                    <table border="0" cellpadding="0" cellspacing="0" style="background-color:#fff;margin:15px">
                        <tbody>
                        <tr>
                            <td align="center" valign="top">
                                <table border="0" cellpadding="0" cellspacing="0" width="100%" style="max-width:600px">
                                    <tbody>
                                    <tr style="padding-bottom:5px;background:#461d9f;background:linear-gradient(to right,#7530a6 0%,#461d9f 50%)">
                                        <td align="left" valign="top">
                                            <div style="font-weight:bold; color: white; padding: 24px; text-transform: uppercase;">Security Alert</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td valign="top" style="padding:25px 25px">
                                            <h2 style="text-align:center;font-size:22px;margin:0 0 5px 0;font-weight:normal;line-height:1.1">
                                                <a style="color:#3777b0;text-decoration:none" href="@Model.RepoUrl()" target="_blank">@Model.Project.Name</a>
                                            </h2>
                                            <div style="margin-bottom:20px">
                                                <h2 style="font-size:22px;margin-top:28px;margin-bottom:10px;font-weight:normal;">
                                                    Vulnerable Packages
                                                </h2>
                                                <table style="width:100%">
                                                    <tbody>
                                                    <tr>
                                                        <td>
                                                            <table border="1" cellpadding="0" cellspacing="0" width="100%"
                                                                   style="margin-bottom:15px;padding-bottom:5px;border:1px solid #c5c5c5;border-collapse: collapse;font-family:Helvetica,Arial,sans-serif">
                                                                <tbody style="padding: 10px">
                                                                <tr valign="top" style="font-weight: bold">
                                                                    <td width="45" style="padding:5px">
                                                                        Package
                                                                    </td>
                                                                    <td style="padding:5px">
                                                                        Fix Version
                                                                    </td>
                                                                </tr>
                                                                @foreach (var package in @Model.ProjectPackages)
                                                                { 
                                                                    <tr valign="top">
                                                                    <td style="padding:5px">
                                                                        <table>
                                                                            <tr>
                                                                                <td>
                                                                                    @{
                                                                                        var color = "#22C55E";
                                                                                        var label = "N";
                                                                                        @switch (package.Package!.RiskLevel)
                                                                                        {
                                                                                            case RiskLevel.Critical:
                                                                                                color = "#ab1a1a";
                                                                                                label = "C";
                                                                                                break;
                                                                                            case RiskLevel.High:
                                                                                                color = "#ce5019";
                                                                                                label = "H";
                                                                                                break;
                                                                                            case RiskLevel.Medium:
                                                                                                color = "#d68000";
                                                                                                label = "M";
                                                                                                break;
                                                                                            case RiskLevel.Low:
                                                                                                color = "#88879e";
                                                                                                label = "L";
                                                                                                break;
                                                                                            default:
                                                                                                color = "#22C55E";
                                                                                                label = "N";
                                                                                                break;
                                                                                        }
                                                                                    }
                                                                                    <div style="background-color:@color;color:#fff;display:block;text-align:center;width:30px">
                                                                                        @label
                                                                                    </div>
                                                                                </td>
                                                                                <td style="white-space: nowrap">
                                                                                    <span style="font-weight:normal;font-size:16px">
                                                                                        @package.Package!.Name
                                                                                    </span>
                                                                                </td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td></td>
                                                                                <td style="font-size:14px;display:block; ">
                                                                                    @package.Location
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </td>
                                                                    <td style="padding:5px">
                                                                        <span style="font-weight:normal;font-size:16px">
                                                                            @package.Package.FixedVersion
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                }
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <table>
                                                                <tr>
                                                                    <td>
                                                                        <a href="@Model.RepoUrl()"
                                                                           style="background-color:#148888;background-image:linear-gradient(-180deg,#148888 0,#096969 100%);border-radius:0;font-size:14px;color:#fff;text-decoration:none;display:block;float:right"
                                                                           target="_blank">
                                                                            <span style="margin:8px 16px;display:block">Open Repo</span>
                                                                        </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="@Model.ProjectUrl()"
                                                                           style="background-color:#148888;background-image:linear-gradient(-180deg,#148888 0,#096969 100%);border-radius:0;font-size:14px;color:#fff;text-decoration:none;display:block;float:right"
                                                                           target="_blank">
                                                                            <span style="margin:8px 16px;display:block">View Dashboard</span>
                                                                        </a>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>

                            </td>
                        </tr>
                        </tbody>
                    </table>

                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <table role="presentation" cellspacing="0" cellpadding="0" border="0" align="center" width="100%"
           style="background:#f6f7fb;color:#000;font-size:15px;line-height:140%;text-align:center;max-width:600px">
        <tbody>
        <tr>
            <td style="font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;font-size:13px;line-height:1.6;color:#5c5c5c;padding:25px 0">
                <div>
                    You're receiving this email because of your account on
                    <a href="@Configuration.FrontendUrl"
                       style="color:#3777b0;text-decoration:none"
                       target="_blank">Code Secure</a>
                </div>
            </td>
        </tr>
        <tr>
            <td style="font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;font-size:13px;line-height:1.6;color:#5c5c5c;padding:25px 0"></td>
        </tr>
        </tbody>
    </table>
</div>