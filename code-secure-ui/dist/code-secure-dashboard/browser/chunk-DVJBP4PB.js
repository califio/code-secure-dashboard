import{a as B,b as y,c as Q}from"./chunk-23W66GLT.js";import{a as P,b as $}from"./chunk-PD5D44HU.js";import{a as q}from"./chunk-FRDTDMZX.js";import{da as G}from"./chunk-G46RF4U2.js";import{b as O}from"./chunk-ZEESFLET.js";import{a as z}from"./chunk-ENGL65RD.js";import{d as v,f as I,g as L}from"./chunk-2IXFTJ2H.js";import{b as N,c as b,d as j,e as U,j as M,l as V,m as A,r as D}from"./chunk-5ASYMZAG.js";import"./chunk-T2ZIFUV5.js";import"./chunk-KENT5INO.js";import{e as F}from"./chunk-FHVUNOKG.js";import{i as R}from"./chunk-3OH2LOAZ.js";import{H as x,Ib as n,Kb as k,Qb as E,Sa as s,Sb as g,Ta as l,ba as S,db as c,fb as m,kb as f,la as w,ma as C,pb as t,qb as o,rb as d,tb as T,wb as u,xb as h}from"./chunk-LUMD5QXA.js";import"./chunk-AIZVJUQQ.js";var H=i=>({"is__invalid-input":i});function X(i,_){if(i&1){let r=T();t(0,"div",19),u("click",function(){w(r);let e=h();return C(e.onOidcLogin())}),t(1,"span"),n(2),o()(),t(3,"div",20)(4,"p",21),n(5,"or"),o()()}if(i&2){let r=h();s(2),k("Log in with ",r.authConfig.openIdConnectProvider,"")}}function Y(i,_){i&1&&(t(0,"div",8)(1,"div"),n(2,"Required field"),o()())}function Z(i,_){i&1&&(t(0,"div",8)(1,"div"),n(2,"Required field"),o()())}var ge=(()=>{class i{formService;authService;authStore;activatedRoute;router;route;toastr;formConfig=new B({password:new y("",b.required),userName:new y("",b.required)});form;submitted=!1;passwordTextType=!1;authResponse={accessToken:null,refreshToken:null,requireConfirmEmail:null,requireTwoFactor:null};authConfig={};constructor(r,a,e,p,J,K,W){this.formService=r,this.authService=a,this.authStore=e,this.activatedRoute=p,this.router=J,this.route=K,this.toastr=W,this.form=this.formService.group(this.formConfig)}ngOnInit(){let r=this.route.snapshot.queryParams;if(r.oidc&&(O(r,this.authResponse),r.message&&this.toastr.warning(r.message,0),this.authResponse.accessToken&&this.authResponse.refreshToken)){this.authStore.accessToken=this.authResponse.accessToken,this.authStore.refreshToken=this.authResponse.refreshToken;let e=this.activatedRoute.snapshot.queryParamMap.get("returnUrl")||"/dashboard";this.router.navigateByUrl(e).then()}this.authService.getAuthConfig().subscribe(e=>{this.authConfig=e})}onOidcLogin(){location.href=`${$.baseUrl}/api/login/oidc`}onPasswordSignIn(){if(this.authConfig.disablePasswordLogon){this.toastr.warning("The administrator disabled password logon");return}this.form.invalid||this.form.disabled||(this.form.disable(),this.authService.login({body:this.form.getRawValue()}).pipe(x(()=>this.form.enable())).subscribe(r=>{this.authStore.accessToken=r.accessToken,this.authStore.refreshToken=r.refreshToken;let a=this.activatedRoute.snapshot.queryParamMap.get("returnUrl")||"/dashboard";this.router.navigateByUrl(a).then()}))}static \u0275fac=function(a){return new(a||i)(l(Q),l(q),l(P),l(v),l(I),l(v),l(G))};static \u0275cmp=S({type:i,selectors:[["app-login"]],standalone:!0,features:[E],decls:30,vars:16,consts:[[1,"my-10","space-y-6","text-white",3,"ngSubmit","formGroup"],[1,"text-center"],[1,"text-sm","text-muted-foreground"],[1,"space-y-3","text-left"],[1,"form__group"],[1,"relative"],["type","text","id","username","placeholder"," ",1,"peer","block","w-full","text-muted-foreground","py-3",3,"ngClass","formControl"],["for","username",1,"absolute","top-2","left-1","z-10","origin-[0]","-translate-y-4","scale-95","transform","bg-background","px-2","text-sm","text-muted-foreground","duration-300","peer-placeholder-shown:top-1/2","peer-placeholder-shown:-translate-y-1/2","peer-placeholder-shown:scale-100","peer-focus:top-2","peer-focus:-translate-y-4","peer-focus:scale-95","peer-focus:px-2","peer-focus:text-primary"],[1,"is__invalid-error"],["id","password","placeholder"," ",1,"peer","block","w-full","text-muted-foreground","py-3",3,"type","ngClass","formControl"],["for","password",1,"absolute","top-2","left-1","z-10","origin-[0]","-translate-y-4","scale-95","transform","bg-background","px-2","text-sm","text-muted-foreground","duration-300","peer-placeholder-shown:top-1/2","peer-placeholder-shown:-translate-y-1/2","peer-placeholder-shown:scale-100","peer-focus:top-2","peer-focus:-translate-y-4","peer-focus:scale-95","peer-focus:px-2","peer-focus:text-primary"],[1,"absolute","top-2.5","right-5","cursor-pointer","text-muted-foreground",3,"click"],[3,"name"],[1,"mb-2","flex","items-center","justify-between","space-x-3"],[1,"flex","items-center"],["id","remember-me","name","remember-me","type","checkbox"],["for","remember-me",1,"ml-2","block","text-sm","text-muted-foreground"],["routerLink","/auth/forgot-password",1,"px-2","rounded","bg-background","hover:bg-primary/10","text-sm","text-muted-foreground","cursor-pointer"],["app-button","","type","primary",1,"rounded-lg","h-10","w-full","justify-center","font-semibold",3,"click","loading","disabled"],[1,"flex","flex-row","justify-center","items-center","rounded-lg","bg-gray-700","gap-2","py-1","cursor-pointer","text-gray-300","font-semibold","h-10",3,"click"],[1,"my-4","flex","items-center","before:mt-0.5","before:flex-1","before:border-t","before:border-muted","after:mt-0.5","after:flex-1","after:border-t","after:border-muted"],[1,"mx-4","mb-0","text-center","text-sm","text-muted-foreground"]],template:function(a,e){a&1&&(t(0,"form",0),u("ngSubmit",function(){return e.onPasswordSignIn()}),c(1,X,6,1),t(2,"div",1)(3,"p",2),n(4,"Enter your credential to access your account."),o()(),t(5,"div",3)(6,"div",4)(7,"div",5),d(8,"input",6),t(9,"label",7),n(10," UserName "),o()(),c(11,Y,3,0,"div",8),o(),t(12,"div",4)(13,"div",5),d(14,"input",9),t(15,"label",10),n(16," Password "),o(),t(17,"span",11),u("click",function(){return e.passwordTextType=!e.passwordTextType}),d(18,"ng-icon",12),o()(),c(19,Z,3,0,"div",8),o()(),t(20,"div",13)(21,"div",14),d(22,"input",15),t(23,"label",16),n(24," Remember me "),o()(),t(25,"div",17),n(26," Forgot your password? "),o()(),t(27,"div")(28,"button",18),u("click",function(){return e.onPasswordSignIn()}),n(29," Sign in "),o()()()),a&2&&(m("formGroup",e.form),s(),f(e.authConfig.openIdConnectEnable?1:-1),s(7),m("ngClass",g(12,H,e.submitted&&e.form.controls))("formControl",e.form.controls.userName),s(3),f(e.submitted&&e.form.controls.userName.getError("required")?11:-1),s(3),m("type",e.passwordTextType?"text":"password")("ngClass",g(14,H,e.submitted&&e.form.controls.userName.getError("required")))("formControl",e.form.controls.password),s(4),m("name",e.passwordTextType?"eye":"eyeSlash"),s(),f(e.submitted&&e.form.controls.password.getError("required")?19:-1),s(9),m("loading",e.form.disabled)("disabled",e.form.disabled))},dependencies:[D,M,N,j,U,V,A,F,L,R,z],styles:[".is__invalid-input[_ngcontent-%COMP%]{border-color:#e11d48}.is__invalid-error[_ngcontent-%COMP%]{color:#e11d48;padding-left:.25rem;padding-right:.25rem;padding-top:.25rem;font-size:.75rem;line-height:1rem}"]})}return i})();export{ge as LoginComponent};
