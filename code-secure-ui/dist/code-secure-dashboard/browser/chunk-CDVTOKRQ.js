import{a as F}from"./chunk-OBWA6DFB.js";import{a as v,b as h,c as D,d as T}from"./chunk-JLJF64GP.js";import{a as g}from"./chunk-4TJNVXQH.js";import"./chunk-PJ57YFKH.js";import"./chunk-UHSV32VQ.js";import{r as O}from"./chunk-5ASYMZAG.js";import{b as w}from"./chunk-PHZ4YKFG.js";import"./chunk-T2ZIFUV5.js";import"./chunk-KENT5INO.js";import{e as C}from"./chunk-FHVUNOKG.js";import"./chunk-3OH2LOAZ.js";import{H as S,Ib as x,Qb as m,Sa as n,Ta as d,ba as p,db as f,fb as r,kb as u,pb as l,qb as s,rb as c,xb as b}from"./chunk-LUMD5QXA.js";import"./chunk-AIZVJUQQ.js";var E=(()=>{class a{themeService;set categories(e){this.chartOptions.xaxis.categories=e.map(i=>i.category),this.chartOptions.series=[{name:"count",data:e.map(i=>i.count)}]}chartOptions;constructor(e){this.themeService=e;let i=h(getComputedStyle(document.documentElement).getPropertyValue("--primary")),o=h(getComputedStyle(document.documentElement).getPropertyValue("--background")),t=this.themeService.isDark?"white":"black";this.chartOptions={theme:{mode:this.themeService.isDark?"dark":"light"},chart:{type:"bar",stacked:!0,height:450,background:o},dataLabels:{enabled:!1},plotOptions:{bar:{horizontal:!0,barHeight:"10",distributed:!1,dataLabels:{total:{enabled:!0,offsetX:5,style:{fontWeight:"normal",color:t}}}}},series:[],grid:{yaxis:{lines:{show:!1,offsetY:10}},padding:{top:10,bottom:10}},xaxis:{categories:[],labels:{show:!0,style:{colors:[t,t,t,t,t,t,t,t,t,t]}}},yaxis:{show:!0,labels:{show:!0,align:"left",offsetX:5,offsetY:15,maxWidth:500,style:{colors:[t,t,t,t,t,t,t,t,t,t]}},floating:!0},title:{text:"Top Findings",style:{color:i}},colors:["#FF0000"]}}ngOnDestroy(){}static \u0275fac=function(i){return new(i||a)(d(g))};static \u0275cmp=p({type:a,selectors:[["top-finding-chart"]],inputs:{categories:"categories"},standalone:!0,features:[m],decls:2,vars:10,consts:[[1,"flex","flex-col","overflow-hidden",2,"min-width","20rem"],[3,"theme","dataLabels","chart","colors","plotOptions","series","xaxis","yaxis","grid","title"]],template:function(i,o){i&1&&(l(0,"div",0),c(1,"apx-chart",1),s()),i&2&&(n(),r("theme",o.chartOptions.theme)("dataLabels",o.chartOptions.dataLabels)("chart",o.chartOptions.chart)("colors",o.chartOptions.colors)("plotOptions",o.chartOptions.plotOptions)("series",o.chartOptions.series)("xaxis",o.chartOptions.xaxis)("yaxis",o.chartOptions.yaxis)("grid",o.chartOptions.grid)("title",o.chartOptions.title))},dependencies:[v]})}return a})();var _=(()=>{class a{themeService;set dependencies(e){this.chartOptions.xaxis.categories=e.map(i=>this.dependencyName(i)),this.chartOptions.series=[],this.chartOptions.series.push({name:"critical",data:e.map(i=>i.critical)}),this.chartOptions.series.push({name:"high",data:e.map(i=>i.high)}),this.chartOptions.series.push({name:"medium",data:e.map(i=>i.medium)}),this.chartOptions.series.push({name:"low",data:e.map(i=>i.low)}),this.chartOptions.series.push({name:"info",data:e.map(i=>i.info)})}chartOptions;constructor(e){this.themeService=e;let i=h(getComputedStyle(document.documentElement).getPropertyValue("--primary")),o=h(getComputedStyle(document.documentElement).getPropertyValue("--background")),t=this.themeService.isDark?"white":"black";this.chartOptions={theme:{mode:this.themeService.isDark?"dark":"light"},chart:{type:"bar",stacked:!0,height:450,background:o},dataLabels:{enabled:!1},legend:{show:!1},plotOptions:{bar:{horizontal:!0,barHeight:"10",distributed:!1,dataLabels:{total:{enabled:!0,offsetX:5,style:{fontWeight:"normal",color:t}}}}},series:[],grid:{yaxis:{lines:{show:!1,offsetY:10}}},xaxis:{categories:[],labels:{show:!0,style:{colors:[t,t,t]}}},yaxis:{show:!0,labels:{show:!0,align:"left",offsetX:5,offsetY:15,maxWidth:500,style:{colors:[t,t,t,t,t,t,t,t,t,t]}},floating:!0},title:{text:"Top Vulnerable Packages",style:{color:i}},colors:["#8F243D","#DC1E27","#FF8E3D","#FFC800","#bef264"]}}dependencyName(e){return e.group?`${e.group}.${e.name}@${e.version}`:`${e.name}@${e.version}`}ngOnDestroy(){}static \u0275fac=function(i){return new(i||a)(d(g))};static \u0275cmp=p({type:a,selectors:[["top-dependency-chart"]],inputs:{dependencies:"dependencies"},standalone:!0,features:[m],decls:2,vars:10,consts:[[1,"flex","flex-col","overflow-hidden","w-full",2,"min-width","20rem"],[1,"w-full",3,"dataLabels","legend","chart","colors","plotOptions","series","xaxis","yaxis","grid","title"]],template:function(i,o){i&1&&(l(0,"div",0),c(1,"apx-chart",1),s()),i&2&&(n(),r("dataLabels",o.chartOptions.dataLabels)("legend",o.chartOptions.legend)("chart",o.chartOptions.chart)("colors",o.chartOptions.colors)("plotOptions",o.chartOptions.plotOptions)("series",o.chartOptions.series)("xaxis",o.chartOptions.xaxis)("yaxis",o.chartOptions.yaxis)("grid",o.chartOptions.grid)("title",o.chartOptions.title))},dependencies:[v]})}return a})();function M(a,y){a&1&&c(0,"ng-icon",5)}function I(a,y){if(a&1&&(l(0,"div",2),c(1,"div",6)(2,"finding-status-chart",7)(3,"top-finding-chart",8),s()),a&2){let e=b();n(),r("severity",e.sastStatistic.severity),n(),r("status",e.sastStatistic.status),n(),r("categories",e.sastStatistic.topFindings)}}function H(a,y){a&1&&c(0,"ng-icon",5)}function P(a,y){if(a&1&&(l(0,"div",2),c(1,"div",6)(2,"finding-status-chart",7)(3,"top-dependency-chart",9),s()),a&2){let e=b();n(),r("severity",e.scaStatistic.severity),n(),r("status",e.scaStatistic.status),n(),r("dependencies",e.scaStatistic.topDependencies)}}var oe=(()=>{class a{dashboardService;sastStatistic={severity:{critical:0,high:0,info:0,low:0,medium:0},status:{acceptedRisk:0,confirmed:0,fixed:0,open:0},topFindings:[]};scaStatistic={severity:{critical:0,high:0,info:0,low:0,medium:0},status:{acceptedRisk:0,confirmed:0,fixed:0,open:0},topDependencies:[]};loadingSast=!1;loadingSca=!1;constructor(e){this.dashboardService=e}ngOnInit(){this.loadingSast=!0,this.loadingSca=!0,this.dashboardService.sastStatistic().pipe(S(()=>this.loadingSast=!1)).subscribe(e=>{this.sastStatistic=e}),this.dashboardService.scaStatistic().pipe(S(()=>this.loadingSca=!1)).subscribe(e=>{this.scaStatistic=e})}static \u0275fac=function(i){return new(i||a)(d(F))};static \u0275cmp=p({type:a,selectors:[["app-dashboard"]],standalone:!0,features:[m],decls:15,vars:4,consts:[[1,"mx-auto","flex","flex-col","text-sm"],[1,"flex","flex-col","overflow-hidden","w-full","border","border-white/5","gap-4","rounded-xl","bg-background","p-6"],[1,"flex","flex-wrap","gap-4","w-full"],[1,"flex","flex-col","gap-4","w-full"],[1,"flex","flex-row","items-center","font-semibold","text-lg","gap-2"],["name","spin",1,"animate-spin"],["severity-chart","",3,"severity"],[3,"status"],[1,"max-w-screen-sm","min-w-[300px]","w-full",3,"categories"],[1,"max-w-screen-sm","min-w-[300px]","w-full",3,"dependencies"]],template:function(i,o){i&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"span"),x(6,"Static Application Security Testing (SAST)"),s(),f(7,M,1,0,"ng-icon",5),s(),f(8,I,4,3,"div",2),s(),l(9,"div",3)(10,"div",4)(11,"span"),x(12,"Software Composition Analysis (SCA)"),s(),f(13,H,1,0,"ng-icon",5),s(),f(14,P,4,3,"div",2),s()()()()),i&2&&(n(7),u(o.loadingSast?7:-1),n(),u(o.loadingSast?-1:8),n(5),u(o.loadingSca?13:-1),n(),u(o.loadingSca?-1:14))},dependencies:[C,O,w,D,T,E,_]})}return a})();export{oe as DashboardComponent};
