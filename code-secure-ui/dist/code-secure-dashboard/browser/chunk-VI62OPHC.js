import{a as yt}from"./chunk-JFWL3IR4.js";import{a as be,b as bt}from"./chunk-NJ6R6LRK.js";import{a as gt}from"./chunk-RLVYGCTC.js";import{a as _t}from"./chunk-2AZPC3K3.js";import{a as dt}from"./chunk-7JDTD5PV.js";import{da as St}from"./chunk-G46RF4U2.js";import{a as Ce,b as xt,c as we,d as ht,e as vt}from"./chunk-KJV7B77S.js";import{a as te,b as A,d as Ct,e as ne,k as se,l as wt,n as Ge}from"./chunk-ZSGDYSVW.js";import{a as ve}from"./chunk-CEX33KBR.js";import{a as ft}from"./chunk-ENGL65RD.js";import{a as q}from"./chunk-32FVIJUL.js";import{g as fe}from"./chunk-2IXFTJ2H.js";import{b as ge,d as _e,h as ct,i as mt,l as pt,q as ee,r as xe}from"./chunk-5ASYMZAG.js";import{a as ut,b as he}from"./chunk-PHZ4YKFG.js";import{e as L}from"./chunk-FHVUNOKG.js";import{i as N,k as st,m as ue,n as Z}from"./chunk-3OH2LOAZ.js";import{Cb as nt,Db as it,Eb as ot,H as me,Hb as ae,Ib as d,Jb as h,Kb as j,Mb as We,Nb as pe,Oa as oe,Ob as Re,Pb as rt,Qa as Ze,Qb as k,Rb as at,Sa as l,Sb as $e,Ta as K,Tb as lt,Ub as W,V as Xe,Vb as X,Wb as Q,Xb as le,Za as re,ba as S,db as g,eb as et,fb as m,hb as Y,jb as tt,kb as f,la as C,lb as V,ma as w,na as ze,nb as z,oa as Be,ob as B,pb as r,qb as a,rb as p,sb as Ne,ta as P,tb as y,wb as x,xa as je,xb as c}from"./chunk-LUMD5QXA.js";function Ut(t,o){if(t&1&&(r(0,"span"),d(1),a()),t&2){let e=c();l(),h(e.fixedLabel())}}function Yt(t,o){if(t&1&&(r(0,"div",2),p(1,"ng-icon",6),r(2,"div"),d(3),a()()),t&2){let e=c();m("ngClass",e.statusOption==null?null:e.statusOption.style),l(),m("name",e.statusOption==null?null:e.statusOption.icon),l(2),h(e.statusOption==null?null:e.statusOption.label)}}function qt(t,o){if(t&1&&(r(0,"span",11),d(1),a()),t&2){let e=c().$implicit;l(),h(e.description)}}function Qt(t,o){if(t&1){let e=y();r(0,"li",7),x("click",function(){let n=C(e).$implicit,s=c();return w(s.onSelectOption(n))}),r(1,"div",8)(2,"div",9)(3,"div",10),p(4,"ng-icon",6),r(5,"span"),d(6),a()(),g(7,qt,2,1,"span",11),a()(),p(8,"input",12),a()}if(t&2){let e=o.$implicit,i=c();Y("bg-card",i._status==e.status),m("ngClass",e.style),l(4),m("name",e.icon),l(2),h(e.label),l(),f(i.showDescription()?7:-1),l(),m("checked",i._status==e.status)}}var kt=(()=>{class t{statusChange=new P;set status(e){this._status=e,this.statusOption=this.statusOptions.find(i=>i.status==e)}_status=A.Open;fixedLabel=je();showDescription=je(!0);statusOption=void 0;hidden=!0;constructor(){}onSelectOption(e){e.status!=A.Fixed&&(this.statusChange.emit(e.status),this.statusOption=e,this.hidden=!0,this._status=e.status)}statusOptions=[{status:A.Open,label:"Open",description:"Newly discovered vulnerabilities. Will remain open until reviewed or retested.",icon:"dotDashCircle",style:"border-b rounded-t-lg cursor-pointer"},{status:A.Confirmed,label:"Confirmed",description:"Vulnerabilities that have been acknowledged as valid and require remediation.",icon:"checkBadge",style:"border-b text-yellow-500 cursor-pointer"},{status:A.Incorrect,label:"False Positive",description:"Vulnerabilities incorrectly identified. Marking as false positive to exclude them from future scans.",icon:"handThumbDown",style:"border-b cursor-pointer"},{status:A.AcceptedRisk,label:"Accepted Risk",description:"Vulnerabilities acknowledged but deemed low risk. Accepted without a fix and excluded from future scans.",icon:"warning",style:"border-b text-orange-500 cursor-pointer"},{status:A.Fixed,label:"Fixed",description:"Vulnerabilities that are no longer detected. Status is updated automatically from future scans.",icon:"checkBadge",style:"rounded-b-lg text-green-500 cursor-not-allowed"}];static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["finding-status"]],inputs:{status:"status",fixedLabel:[1,"fixedLabel"],showDescription:[1,"showDescription"]},outputs:{statusChange:"statusChange"},standalone:!0,features:[k],decls:9,vars:3,consts:[[1,"flex","flex-col","items-start"],[1,"flex","flex-row","items-center","gap-1","rounded","px-4","py-2","font-semibold","w-fit","text-nowrap",3,"click","clickOutside"],[1,"flex","flex-row","items-center","gap-1","border-none",3,"ngClass"],["name","heroChevronDown"],[1,"z-10","absolute","mt-10","rounded-lg","shadow","w-fit","border","border-border","bg-background"],[1,"flex","flex-row","items-center","justify-between","gap-2","px-4","py-2","text-sm","border-border","space-x-1","hover:bg-card","bg-background",3,"bg-card","ngClass"],[3,"name"],[1,"flex","flex-row","items-center","justify-between","gap-2","px-4","py-2","text-sm","border-border","space-x-1","hover:bg-card","bg-background",3,"click","ngClass"],[1,"max-w-72"],[1,"flex","flex-col","gap-2","text-sm"],[1,"font-bold","flex","flex-row","items-center","gap-2"],[1,"text-[#A1A1AB]"],["type","checkbox",3,"checked"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"button",1),x("click",function(){return n.hidden=!n.hidden})("clickOutside",function(){return n.hidden=!0}),g(2,Ut,2,1,"span")(3,Yt,4,3,"div",2),p(4,"ng-icon",3),a(),r(5,"div",4)(6,"ul"),z(7,Qt,9,7,"li",5,V),a()()()),i&2&&(l(2),f(n.fixedLabel()!=null?2:3),l(3),Y("hidden",n.hidden),l(2),B(n.statusOptions))},dependencies:[L,N,q]})}return t})();var Jt=(t,o)=>[t,o],Tt=(()=>{class t{defaultIcon="";defaultLabel="Status";status=A.Open;ngClass="";getFindingStatusIcon=Ce;getFindingStatusLabel=xt;getFindingStatusColor=we;static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["finding-status-label"]],inputs:{defaultIcon:"defaultIcon",defaultLabel:"defaultLabel",status:"status",ngClass:"ngClass"},standalone:!0,features:[k],decls:4,vars:6,consts:[[1,"flex","flex-row","items-center","gap-1","border-none",3,"ngClass"],[3,"name"]],template:function(i,n){i&1&&(r(0,"div",0),p(1,"ng-icon",1),r(2,"div"),d(3),a()()),i&2&&(m("ngClass",lt(3,Jt,n.getFindingStatusColor(n.status),n.ngClass)),l(),m("name",n.status?n.getFindingStatusIcon(n.status):n.defaultIcon),l(2),h(n.status?n.getFindingStatusLabel(n.status):n.defaultLabel))},dependencies:[L,N]})}return t})();var Ai=(()=>{class t{scanner="";type=se.Sast;static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["scanner-label"]],inputs:{scanner:"scanner",type:"type"},standalone:!0,features:[k],decls:5,vars:2,consts:[[1,"flex","flex-row","items-center","gap-1","border-none","text-nowrap"],[1,"lowercase","text-xs","border","border-border","px-1","rounded","w-fit","text-[#0B5CAD]","bg-[#CBE2F9]","dark:bg-[#0B5CAD]","dark:text-[#CBE2F9]"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"span"),d(2),a(),r(3,"div",1),d(4),a()()),i&2&&(l(2),h(n.scanner),l(2),j(" ",n.type," "))}})}return t})();function Kt(t,o){if(t&1&&(r(0,"span",8),d(1,"to"),a(),r(2,"span"),d(3),a()),t&2){let e=c(2);l(3),h(e.selectedOption.targetBranch)}}function Xt(t,o){if(t&1&&(r(0,"div",2),p(1,"ng-icon",7),r(2,"span"),d(3),a(),g(4,Kt,4,1),a()),t&2){let e=c();l(),m("name",e.getGitActionIcon(e.selectedOption.action)),l(2),h(e.selectedOption.branch),l(),f(e.selectedOption.action==e.GitAction.MergeRequest?4:-1)}}function Zt(t,o){t&1&&(r(0,"span"),d(1,"Branch"),a())}function en(t,o){if(t&1&&(r(0,"span",8),d(1,"to"),a(),r(2,"span"),d(3),a()),t&2){let e=c().$implicit;l(3),h(e.targetBranch)}}function tn(t,o){if(t&1){let e=y();r(0,"li",9),x("click",function(){let n=C(e).$implicit,s=c();return w(s.onClick(n))}),r(1,"div",10)(2,"div",11),p(3,"ng-icon",7),r(4,"span"),d(5),a(),g(6,en,4,1),a(),p(7,"ng-icon",12),a()()}if(t&2){let e=o.$implicit,i=c();m("ngClass",e.scanId==(i.selectedOption==null?null:i.selectedOption.scanId)?"bg-gray-100 dark:bg-card":""),l(3),m("name",i.getGitActionIcon(e.action)),l(2),h(e.branch),l(),f(e.action==i.GitAction.MergeRequest?6:-1),l(),m("name",i.getFindingStatusIcon(e.status))("ngClass",i.getFindingStatusColor(e.status))}}var Et=(()=>{class t{hidden=!0;label="Branch";selectedOption;set selected(e){this.selectedOption=this.options.find(i=>i.scanId==e)}options=[];selectChange=new P;onClick(e){this.selectedOption=e,this.selectChange.emit(e.scanId)}GitAction=te;getGitActionIcon=ht;getFindingStatusIcon=Ce;getFindingStatusColor=we;static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["finding-scan-dropdown"]],inputs:{selected:"selected",options:"options"},outputs:{selectChange:"selectChange"},standalone:!0,features:[k],decls:9,vars:3,consts:[[1,"flex","flex-col","items-center"],[1,"flex","flex-row","items-center","gap-1","rounded-md","px-3","py-1.5","font-semibold","w-fit",3,"click","clickOutside"],[1,"flex","flex-row","items-center","text-nowrap","gap-2","text-[#00c869]"],["name","heroChevronDown"],[1,"z-10","absolute","mt-10","rounded-lg","shadow","w-fit","border","border-border","bg-background"],[1,"py-2"],[1,"cursor-pointer","mx-2","px-2","py-1","rounded","bg-background","placeholder-muted-foreground","hover:bg-gray-100","dark:hover:bg-card",3,"ngClass"],[3,"name"],[1,"text-muted-foreground"],[1,"cursor-pointer","mx-2","px-2","py-1","rounded","bg-background","placeholder-muted-foreground","hover:bg-gray-100","dark:hover:bg-card",3,"click","ngClass"],[1,"flex","flex-row","items-center","justify-between","w-full","gap-4"],[1,"flex","flex-row","items-center","gap-2","text-[#00c869]"],[3,"name","ngClass"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"button",1),x("click",function(){return n.hidden=!n.hidden})("clickOutside",function(){return n.hidden=!0}),g(2,Xt,5,3,"div",2)(3,Zt,2,0,"span"),p(4,"ng-icon",3),a(),r(5,"div",4)(6,"ul",5),z(7,tn,8,6,"li",6,V),a()()()),i&2&&(l(2),f(n.selectedOption?2:3),l(3),Y("hidden",n.hidden),l(2),B(n.options))},dependencies:[L,q,N]})}return t})();var Ft=(()=>{class t{severity=ne.Low;style(){return this.severity==ne.Critical?"bg-critical":this.severity==ne.High?"bg-high":this.severity==ne.Medium?"bg-medium":this.severity==ne.Low?"bg-low":"bg-info"}severityLabel(){return this.severity&&this.severity.length>0?this.severity.charAt(0):"U"}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["finding-severity"]],inputs:{severity:"severity"},standalone:!0,features:[k],decls:4,vars:5,consts:[[1,"w-6","h-6","items-center","flex","flex-row","justify-center","text-center","text-white",3,"tooltip","ngClass"]],template:function(i,n){i&1&&(r(0,"div",0),W(1,"lowercase"),r(2,"span"),d(3),a()()),i&2&&(m("tooltip",X(1,3,n.severity))("ngClass",n.style()),l(3),h(n.severityLabel()))},dependencies:[N,ve,ue]})}return t})();function nn(t,o){t&1&&Ne(0)}function on(t,o){if(t&1&&g(0,nn,1,0,"ng-container",5),t&2){let e=c(2);m("ngTemplateOutlet",e.afterDateTemplate)}}function rn(t,o){if(t&1&&(r(0,"div",3)(1,"span"),d(2),W(3,"date"),a(),g(4,on,1,1,"ng-container"),a()),t&2){let e=c();l(2),j(" ",Q(3,2,e.date,e.format)," "),l(2),f(e.afterDateTemplate?4:-1)}}function an(t,o){t&1&&Ne(0)}function ln(t,o){t&1&&(r(0,"span",6),d(1,"Select Date"),a())}function sn(t,o){if(t&1&&g(0,an,1,0,"ng-container",5)(1,ln,2,0,"ng-template",null,0,le),t&2){let e=ae(2),i=c();m("ngTemplateOutlet",i.titleTemplate||e)}}function dn(t,o){if(t&1&&(r(0,"span",18),d(1),a()),t&2){let e=o.$implicit;l(),h(e)}}function cn(t,o){if(t&1){let e=y();r(0,"div")(1,"div",20),x("click",function(){let n=C(e).$implicit,s=c(3);return w(s.selectDate(n))}),d(2),a()()}if(t&2){let e=o.$implicit,i=c(3);l(),tt(i.getDayClasses(e)),l(),j(" ",e.value," ")}}function mn(t,o){if(t&1&&(r(0,"div",19),z(1,cn,3,3,"div",null,V),a()),t&2){let e=o.$implicit;l(),B(e)}}function pn(t,o){if(t&1){let e=y();r(0,"div",4)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10),x("click",function(){C(e);let n=c();return w(n.prevMonth())}),ze(),r(5,"svg",11),p(6,"path",12),a()()(),Be(),r(7,"div",13)(8,"div"),d(9),a(),r(10,"span"),d(11,"/"),a(),r(12,"div"),d(13),a()(),r(14,"div",14)(15,"div",15),x("click",function(){C(e);let n=c();return w(n.nextMonth())}),ze(),r(16,"svg",11),p(17,"path",16),a()()()(),Be(),r(18,"div",17),z(19,dn,2,1,"span",18,V),a(),z(21,mn,3,0,"div",19,V),a()()}if(t&2){let e=c();l(9),h(e.currentMonthName),l(4),h(e.currentYear),l(6),B(e.daysOfWeek),l(2),B(e.weeks)}}var Dt=(()=>{class t{titleTemplate;afterDateTemplate;format="yyyy-MM-dd";dateChange=new P;set date(e){this._date=e,this.initDate()}get date(){return this._date}_date=null;currentMonth;currentYear;today=new Date;isCalendarOpen=!1;daysOfWeek=["Mo","Tu","We","Th","Fr","Sa","Su"];weeks=[];get currentMonthName(){return new Intl.DateTimeFormat("en-US",{month:"long"}).format(new Date(this.currentYear,this.currentMonth))}constructor(){}ngOnInit(){this.generateCalendar()}initDate(){this.today=new Date;let e=this.today;this._date&&(e=this._date),this.currentMonth=e.getMonth(),this.currentYear=e.getFullYear()}toggleCalendar(){this.isCalendarOpen=!this.isCalendarOpen,this.isCalendarOpen&&this.initDate()}closeCalendar(){this.isCalendarOpen=!1}generateCalendar(){let e=new Date(this.currentYear,this.currentMonth,1),i=new Date(this.currentYear,this.currentMonth+1,0),n=e.getDay()===0?6:e.getDay()-1,s=i.getDate(),u=[];for(let _=n;_>0;_--){let R=new Date(this.currentYear,this.currentMonth,-_+1);u.push({value:R.getDate(),active:!1})}for(let _=1;_<=s;_++)u.push({value:_,active:!0});let v=7-u.length%7;if(v<7)for(let _=1;_<=v;_++){let R=new Date(this.currentYear,this.currentMonth+1,_);u.push({value:R.getDate(),active:!1})}for(this.weeks=[];u.length;)this.weeks.push(u.splice(0,7))}prevMonth(){this.currentMonth===0?(this.currentMonth=11,this.currentYear-=1):this.currentMonth-=1,this.generateCalendar()}nextMonth(){this.currentMonth===11?(this.currentMonth=0,this.currentYear+=1):this.currentMonth+=1,this.generateCalendar()}selectDate(e){e.active&&(this.date=new Date(this.currentYear,this.currentMonth,e.value),this.dateChange.emit(this.date),this.closeCalendar())}getDayClasses(e){let i="m-px size-10 flex justify-center items-center text-sm rounded-full text-gray-800 dark:text-neutral-200 hover:text-primary",n=this.date?.getDate()===e.value&&this.date.getMonth()===this.currentMonth&&this.date.getFullYear()===this.currentYear,s=this.today.getDate()===e.value&&this.today.getMonth()===this.currentMonth&&this.today.getFullYear()===this.currentYear,u=n?"bg-primary text-white hover:text-white":"",v=s?"border border-primary":"border-none",_=`${i} ${v}`;return e.active?(_+=" cursor-pointer",n&&(_+=` ${u}`),s&&(_+=` ${v}`)):_+=" opacity-50 cursor-not-allowed",_}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["date-picker"]],inputs:{titleTemplate:"titleTemplate",afterDateTemplate:"afterDateTemplate",format:"format",date:"date"},outputs:{dateChange:"dateChange"},standalone:!0,features:[k],decls:5,vars:2,consts:[["defaultTemplateTitle",""],[1,"relative","text-xs",3,"clickOutside"],[1,"text-nowrap",3,"click"],[1,"flex","flex-row","items-center","text-nowrap","gap-2","border","border-border","px-3","py-2","rounded-md","cursor-pointer"],[1,"absolute","mt-2","z-50","w-80","flex","flex-col","bg-background","border","border-border","shadow-lg","rounded-xl","overflow-hidden"],[4,"ngTemplateOutlet"],[1,"border","border-border","px-4","py-2","rounded-md","cursor-pointer"],[1,"p-3","space-y-0.5"],[1,"grid","grid-cols-5","items-center","gap-x-3","mx-1.5","pb-3"],[1,"col-span-1"],["aria-label","Previous",1,"cursor-pointer","size-8","flex","justify-center","items-center","rounded-full","hover:bg-background",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"shrink-0","size-4"],["d","m15 18-6-6 6-6"],[1,"col-span-3","flex","justify-center","items-center","gap-x-1","text-base"],[1,"col-span-1","flex","justify-end"],["aria-label","Next",1,"cursor-pointer","size-8","flex","justify-center","items-center","rounded-full","hover:bg-background",3,"click"],["d","m9 18 6-6-6-6"],[1,"flex","pb-1.5"],[1,"m-px","w-10","block","text-center","text-sm","text-gray-500","dark:text-neutral-500"],[1,"flex"],[3,"click"]],template:function(i,n){i&1&&(r(0,"div",1),x("clickOutside",function(){return n.isCalendarOpen=!1}),r(1,"div",2),x("click",function(){return n.toggleCalendar()}),g(2,rn,5,5,"div",3)(3,sn,3,1),a(),g(4,pn,23,2,"div",4),a()),i&2&&(l(2),f(n.date?2:3),l(2),f(n.isCalendarOpen?4:-1))},dependencies:[ee,Z,q,st]})}return t})();function un(t,o){if(t&1&&(r(0,"div",1),p(1,"avatar",8),a()),t&2){let e,i=c();l(),m("text",i.activity.username)("size",38)("src",(e=i.activity.avatar)!==null&&e!==void 0?e:void 0)}}function fn(t,o){if(t&1&&(r(0,"span",2),p(1,"ng-icon",9),a()),t&2){let e=c();l(),m("name",e.activity.type==e.FindingActivityType.Open?"heroClock":(e.activity.type==e.FindingActivityType.ChangeStatus,"dotDashCircle"))}}function gn(t,o){if(t&1&&(r(0,"span",5),d(1),a()),t&2){let e=c();l(),h(e.activity.username)}}function _n(t,o){t&1&&(r(0,"span",5),d(1,"system"),a())}function xn(t,o){if(t&1&&(r(0,"span"),d(1,"change status"),a(),r(2,"div",4)(3,"div",4),p(4,"finding-status-label",10),r(5,"span"),d(6,"to"),a(),p(7,"finding-status-label",10),a()()),t&2){let e=c();l(4),m("ngClass","px-1 py-0.5 border border-border")("status",e.activity.metadata==null||e.activity.metadata.changeStatus==null?null:e.activity.metadata.changeStatus.previousStatus),l(3),m("ngClass","px-1 py-0.5 border border-border")("status",e.activity.metadata==null||e.activity.metadata.changeStatus==null?null:e.activity.metadata.changeStatus.currentStatus)}}function hn(t,o){if(t&1&&(r(0,"div",12),d(1),W(2,"date"),a()),t&2){let e=c(2);l(),j(" ",Q(2,1,e.parseDate(e.activity.metadata==null||e.activity.metadata.changeDeadline==null?null:e.activity.metadata.changeDeadline.previousDate),"dd/MM/yyyy")," ")}}function vn(t,o){if(t&1&&(r(0,"span"),d(1,"change fix deadline"),a(),r(2,"div",11),g(3,hn,3,4,"div",12),r(4,"span"),d(5,"to"),a(),r(6,"div",12),d(7),W(8,"date"),a()()),t&2){let e=c();l(3),f(!(e.activity.metadata==null||e.activity.metadata.changeDeadline==null)&&e.activity.metadata.changeDeadline.previousDate?3:-1),l(4),j(" ",Q(8,2,e.parseDate(e.activity.metadata==null||e.activity.metadata.changeDeadline==null?null:e.activity.metadata.changeDeadline.currentDate),"dd/MM/yyyy")," ")}}function Cn(t,o){t&1&&(r(0,"span"),d(1,"first seen"),a())}function wn(t,o){if(t&1&&p(0,"finding-status-label",7),t&2){let e=c();m("status",e.FindingStatus.Fixed)}}function bn(t,o){t&1&&(r(0,"span"),d(1,"seen again"),a())}function yn(t,o){if(t&1&&(r(0,"span"),d(1,"on"),a(),p(2,"scan-branch",13)),t&2){let e,i,n=c();l(2),m("action",(e=n.activity.metadata==null||n.activity.metadata.scanInfo==null?null:n.activity.metadata.scanInfo.action)!==null&&e!==void 0?e:n.GitAction.CommitBranch)("branch",(i=n.activity.metadata==null||n.activity.metadata.scanInfo==null?null:n.activity.metadata.scanInfo.branch)!==null&&i!==void 0?i:"")("targetBranch",n.activity.metadata==null||n.activity.metadata.scanInfo==null?null:n.activity.metadata.scanInfo.targetBranch)}}function Sn(t,o){if(t&1&&(r(0,"p"),d(1),a()),t&2){let e=c();l(),h(e.activity.comment)}}var Mt=(()=>{class t{activity={};parseDate(e){return e?new Date(e):null}FindingActivityType=Ct;GitAction=te;FindingStatus=A;static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["finding-activity"]],inputs:{activity:"activity"},standalone:!0,features:[k],decls:18,vars:9,consts:[[1,"mt-10","ms-6"],[1,"absolute","-start-5"],[1,"absolute","flex","items-center","justify-center","w-6","h-6","bg-blue-100","rounded-full","-start-3","dark:bg-blue-900"],[1,"flex","flex-row","items-center","justify-between","gap-2","mb-1"],[1,"flex","flex-row","items-center","gap-2"],[1,"font-semibold"],[1,"block","text-xs",3,"tooltip"],[3,"status"],[3,"text","size","src"],[3,"name"],[3,"ngClass","status"],[1,"flex","flex-row","items-center","gap-2","text-xs"],[1,"flex","text-nowrap","border","border-border","px-2","py-1","rounded-md"],[3,"action","branch","targetBranch"]],template:function(i,n){if(i&1&&(r(0,"li",0),g(1,un,2,3,"div",1)(2,fn,2,1,"span",2),r(3,"div",3)(4,"div",4),g(5,gn,2,1,"span",5)(6,_n,2,0,"span",5),a(),r(7,"time",6),d(8),W(9,"timeago"),a()(),r(10,"div",4),g(11,xn,8,4)(12,vn,9,5)(13,Cn,2,0,"span")(14,wn,1,1,"finding-status-label",7)(15,bn,2,0,"span")(16,yn,3,3),a(),g(17,Sn,2,1,"p"),a()),i&2){let s;l(),f(n.activity.username?1:2),l(4),f(n.activity.username?5:6),l(2),m("tooltip",n.activity.createdAt),l(),h(X(9,7,n.activity.createdAt)),l(3),f((s=n.activity.type)===n.FindingActivityType.ChangeStatus?11:s===n.FindingActivityType.ChangeDeadline?12:s===n.FindingActivityType.Open?13:s===n.FindingActivityType.Fixed?14:s===n.FindingActivityType.Reopen?15:-1),l(5),f(n.activity.metadata!=null&&n.activity.metadata.scanInfo?16:-1),l(),f(n.activity.comment?17:-1)}},dependencies:[dt,Tt,L,vt,he,ut,ve,Z]})}return t})();var It=(()=>{class t{loading=re(!1);constructor(){}static \u0275fac=function(i){return new(i||t)};static \u0275prov=Xe({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Tn(t,o){if(t&1){let e=y();r(0,"div",0)(1,"a",3),p(2,"ng-icon",4),r(3,"span",5),d(4),a()(),r(5,"ng-icon",6),x("click",function(){C(e);let n=c();return w(n.deleteTicket())}),a()()}if(t&2){let e=c();l(),m("href",e.ticket.url,oe),l(),m("name",e.ticketIcon(e.ticket)),l(2),h(e.ticket.name)}}function En(t,o){t&1&&p(0,"ng-icon",10)}function Fn(t,o){t&1&&p(0,"ng-icon",11)}function Dn(t,o){if(t&1){let e=y();r(0,"div",19),x("click",function(){C(e);let n=c(2);return w(n.createTicket(n.TicketType.Jira))}),p(1,"ng-icon",20),r(2,"span"),d(3,"JIRA"),a()()}}function Mn(t,o){if(t&1){let e=y();r(0,"div",7),x("clickOutside",function(){C(e);let n=c();return w(n.hidden=!0)}),r(1,"button",8),x("click",function(){C(e);let n=c();return w(n.hidden=!n.hidden)}),r(2,"div",9),g(3,En,1,0,"ng-icon",10)(4,Fn,1,0,"ng-icon",11),r(5,"span",12),d(6,"Ticket"),a(),p(7,"ng-icon",13),a()(),r(8,"div",14)(9,"ul",15),g(10,Dn,4,0,"div",16),r(11,"div",17),p(12,"ng-icon",18),r(13,"span"),d(14,"Add Integration"),a()()()()()}if(t&2){let e=c();l(3),f(e.loading?3:4),l(5),Y("hidden",e.hidden),l(2),f(e.issueTracker.get(e.TicketType.Jira)?10:-1)}}var Ot=(()=>{class t{store;integrationService;ticket=void 0;loading=!1;onTicket=new P;onDelete=new P;hidden=!0;issueTracker=new Map;constructor(e,i){this.store=e,this.integrationService=i}ngOnInit(){this.store.loading.set(!0),this.integrationService.getTicketTrackers().subscribe(e=>{e.forEach(i=>{this.issueTracker.set(i.type,i.active)})})}createTicket(e){this.loading||this.onTicket.emit(e)}ticketIcon(e){return e.type==Ge.Jira?"jira":"heroFlag"}TicketType=Ge;showConfirmPopup=!1;deleteTicket(){this.showConfirmPopup=!0}confirmDelete(){this.onDelete.emit(this.ticket),this.showConfirmPopup=!1}static \u0275fac=function(i){return new(i||t)(K(It),K(_t))};static \u0275cmp=S({type:t,selectors:[["ticket-dropdown"]],inputs:{ticket:"ticket",loading:"loading"},outputs:{onTicket:"onTicket",onDelete:"onDelete"},standalone:!0,features:[k],decls:3,vars:2,consts:[[1,"flex","flex-row","items-center","gap-2","rounded","border","border-border","bg-background","px-3","text-sm","w-fit","text-nowrap","cursor-pointer"],[1,"flex","flex-col","w-fit"],[3,"cancel","confirm","hidden"],["target","_blank",1,"flex","flex-row","items-center","gap-2",3,"href"],["size","20",3,"name"],[1,"my-2","text-xs","font-semibold"],["name","trash",1,"text-primary",3,"click"],[1,"flex","flex-col","w-fit",3,"clickOutside"],[1,"flex","flex-row","items-center","gap-2","rounded","border","border-border","px-3","w-fit","text-nowrap","cursor-pointer",3,"click"],[1,"flex","flex-row","items-center","gap-2","my-2"],["name","spin",1,"animate-spin"],["name","heroFlag"],[1,"font-semibold"],["name","heroChevronDown"],[1,"z-10","absolute","mt-10","rounded","shadow","w-fit","border","border-border","bg-background"],[1,"py-2","flex","flex-col","gap-1","max-h-60","overflow-y-auto"],[1,"flex","flex-row","items-center","gap-1","hover:bg-gray-100","dark:hover:bg-gray-900/70","mx-1","rounded","cursor-pointer","px-2","py-1","bg-background","placeholder-muted-foreground"],["routerLink","/setting/integration",1,"flex","flex-row","items-center","gap-2","w-full","px-4","py-2","border-t","border-border","cursor-pointer"],["name","plugin"],[1,"flex","flex-row","items-center","gap-1","hover:bg-gray-100","dark:hover:bg-gray-900/70","mx-1","rounded","cursor-pointer","px-2","py-1","bg-background","placeholder-muted-foreground",3,"click"],["name","jira","size","20"]],template:function(i,n){i&1&&(g(0,Tn,6,3,"div",0)(1,Mn,15,4,"div",1),r(2,"confirm-popup",2),x("cancel",function(){return n.showConfirmPopup=!1})("confirm",function(){return n.confirmDelete()}),a()),i&2&&(f(n.ticket?0:1),l(2),m("hidden",!n.showConfirmPopup))},dependencies:[L,ee,q,fe,yt]})}return t})();var Pt=function(t,o,e,i){if(e==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof o=="function"?t!==o||!i:!o.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?i:e==="a"?i.call(t):i?i.value:o.get(t)},ye,He,In=["[data-md-button]","md-header","md-bold","md-italic","md-quote","md-code","md-link","md-image","md-unordered-list","md-ordered-list","md-task-list","md-mention","md-ref","md-strikethrough"];function Nt(t){let o=[];for(let e of t.querySelectorAll(In.join(", ")))e.hidden||e.offsetWidth<=0&&e.offsetHeight<=0||e.closest("markdown-toolbar")===t&&o.push(e);return o}function Wt(t){return function(o){(o.key===" "||o.key==="Enter")&&t(o)}}var I=new WeakMap,On={"header-1":{prefix:"# "},"header-2":{prefix:"## "},"header-3":{prefix:"### "},"header-4":{prefix:"#### "},"header-5":{prefix:"##### "},"header-6":{prefix:"###### "},bold:{prefix:"**",suffix:"**",trimFirst:!0},italic:{prefix:"_",suffix:"_",trimFirst:!0},quote:{prefix:"> ",multiline:!0,surroundWithNewlines:!0},code:{prefix:"`",suffix:"`",blockPrefix:"```",blockSuffix:"```"},link:{prefix:"[",suffix:"](url)",replaceNext:"url",scanFor:"https?://"},image:{prefix:"![",suffix:"](url)",replaceNext:"url",scanFor:"https?://"},"unordered-list":{prefix:"- ",multiline:!0,unorderedList:!0},"ordered-list":{prefix:"1. ",multiline:!0,orderedList:!0},"task-list":{prefix:"- [ ] ",multiline:!0,surroundWithNewlines:!0},mention:{prefix:"@",prefixSpace:!0},ref:{prefix:"#",prefixSpace:!0},strikethrough:{prefix:"~~",suffix:"~~",trimFirst:!0}},O=class extends HTMLElement{constructor(){super();let o=e=>{let i=I.get(this);i&&(e.preventDefault(),qe(this,i))};this.addEventListener("keydown",Wt(o)),this.addEventListener("click",o)}connectedCallback(){this.hasAttribute("role")||this.setAttribute("role","button")}click(){let o=I.get(this);o&&qe(this,o)}},Se=class extends O{constructor(){super(...arguments),ye.add(this)}connectedCallback(){let o=parseInt(this.getAttribute("level")||"3",10);Pt(this,ye,"m",He).call(this,o)}static get observedAttributes(){return["level"]}attributeChangedCallback(o,e,i){if(o!=="level")return;let n=parseInt(i||"3",10);Pt(this,ye,"m",He).call(this,n)}};ye=new WeakSet,He=function(o){if(o<1||o>6)return;let e=`${"#".repeat(o)} `;I.set(this,{prefix:e})};window.customElements.get("md-header")||(window.MarkdownHeaderButtonElement=Se,window.customElements.define("md-header",Se));var ke=class extends O{connectedCallback(){I.set(this,{prefix:"**",suffix:"**",trimFirst:!0})}};window.customElements.get("md-bold")||(window.MarkdownBoldButtonElement=ke,window.customElements.define("md-bold",ke));var Te=class extends O{connectedCallback(){I.set(this,{prefix:"_",suffix:"_",trimFirst:!0})}};window.customElements.get("md-italic")||(window.MarkdownItalicButtonElement=Te,window.customElements.define("md-italic",Te));var Ee=class extends O{connectedCallback(){I.set(this,{prefix:"> ",multiline:!0,surroundWithNewlines:!0})}};window.customElements.get("md-quote")||(window.MarkdownQuoteButtonElement=Ee,window.customElements.define("md-quote",Ee));var Fe=class extends O{connectedCallback(){I.set(this,{prefix:"`",suffix:"`",blockPrefix:"```",blockSuffix:"```"})}};window.customElements.get("md-code")||(window.MarkdownCodeButtonElement=Fe,window.customElements.define("md-code",Fe));var De=class extends O{connectedCallback(){I.set(this,{prefix:"[",suffix:"](url)",replaceNext:"url",scanFor:"https?://"})}};window.customElements.get("md-link")||(window.MarkdownLinkButtonElement=De,window.customElements.define("md-link",De));var Me=class extends O{connectedCallback(){I.set(this,{prefix:"![",suffix:"](url)",replaceNext:"url",scanFor:"https?://"})}};window.customElements.get("md-image")||(window.MarkdownImageButtonElement=Me,window.customElements.define("md-image",Me));var Ie=class extends O{connectedCallback(){I.set(this,{prefix:"- ",multiline:!0,unorderedList:!0})}};window.customElements.get("md-unordered-list")||(window.MarkdownUnorderedListButtonElement=Ie,window.customElements.define("md-unordered-list",Ie));var Oe=class extends O{connectedCallback(){I.set(this,{prefix:"1. ",multiline:!0,orderedList:!0})}};window.customElements.get("md-ordered-list")||(window.MarkdownOrderedListButtonElement=Oe,window.customElements.define("md-ordered-list",Oe));var Pe=class extends O{connectedCallback(){I.set(this,{prefix:"- [ ] ",multiline:!0,surroundWithNewlines:!0})}};window.customElements.get("md-task-list")||(window.MarkdownTaskListButtonElement=Pe,window.customElements.define("md-task-list",Pe));var Le=class extends O{connectedCallback(){I.set(this,{prefix:"@",prefixSpace:!0})}};window.customElements.get("md-mention")||(window.MarkdownMentionButtonElement=Le,window.customElements.define("md-mention",Le));var Ae=class extends O{connectedCallback(){I.set(this,{prefix:"#",prefixSpace:!0})}};window.customElements.get("md-ref")||(window.MarkdownRefButtonElement=Ae,window.customElements.define("md-ref",Ae));var Ve=class extends O{connectedCallback(){I.set(this,{prefix:"~~",suffix:"~~",trimFirst:!0})}};window.customElements.get("md-strikethrough")||(window.MarkdownStrikethroughButtonElement=Ve,window.customElements.define("md-strikethrough",Ve));function Lt(t){let{target:o,currentTarget:e}=t;if(!(o instanceof Element))return;let i=o.closest("[data-md-button]");if(!i||i.closest("markdown-toolbar")!==e)return;let n=i.getAttribute("data-md-button"),s=On[n];s&&(t.preventDefault(),qe(o,s))}function At(t){t.addEventListener("keydown",$t),t.setAttribute("tabindex","0"),t.addEventListener("focus",Rt,{once:!0})}function Vt(t){t.removeEventListener("keydown",$t),t.removeAttribute("tabindex"),t.removeEventListener("focus",Rt)}var Ue=(()=>{class t extends HTMLElement{connectedCallback(){this.hasAttribute("role")||this.setAttribute("role","toolbar"),this.hasAttribute("data-no-focus")||At(this),this.addEventListener("keydown",Wt(Lt)),this.addEventListener("click",Lt)}attributeChangedCallback(e,i,n){e==="data-no-focus"&&(n===null?At(this):Vt(this))}disconnectedCallback(){Vt(this)}get field(){let e=this.getAttribute("for");if(!e)return null;let i="getRootNode"in this?this.getRootNode():document,n;return(i instanceof Document||i instanceof ShadowRoot)&&(n=i.getElementById(e)),n instanceof HTMLTextAreaElement?n:null}}return t.observedAttributes=["data-no-focus"],t})();function Rt({target:t}){if(!(t instanceof Element))return;t.removeAttribute("tabindex");let o="0";for(let e of Nt(t))e.setAttribute("tabindex",o),o==="0"&&(e.focus(),o="-1")}function $t(t){let o=t.key;if(o!=="ArrowRight"&&o!=="ArrowLeft"&&o!=="Home"&&o!=="End")return;let e=t.currentTarget;if(!(e instanceof HTMLElement))return;let i=Nt(e),n=i.indexOf(t.target),s=i.length;if(n===-1)return;let u=0;o==="ArrowLeft"&&(u=n-1),o==="ArrowRight"&&(u=n+1),o==="End"&&(u=s-1),u<0&&(u=s-1),u>s-1&&(u=0);for(let v=0;v<s;v+=1)i[v].setAttribute("tabindex",v===u?"0":"-1");t.preventDefault(),i[u].focus()}window.customElements.get("markdown-toolbar")||(window.MarkdownToolbarElement=Ue,window.customElements.define("markdown-toolbar",Ue));function Ye(t){return t.trim().split(`
`).length>1}function zt(t,o){return Array(o+1).join(t)}function Pn(t,o){let e=o;for(;t[e]&&t[e-1]!=null&&!t[e-1].match(/\s/);)e--;return e}function Ln(t,o,e){let i=o,n=e?/\n/:/\s/;for(;t[i]&&!t[i].match(n);)i++;return i}var J=null;function An(t,{text:o,selectionStart:e,selectionEnd:i}){let n=t.selectionStart,s=t.value.slice(0,n),u=t.value.slice(t.selectionEnd);if(J===null||J===!0){t.contentEditable="true";try{J=document.execCommand("insertText",!1,o)}catch{J=!1}t.contentEditable="false"}if(J&&!t.value.slice(0,t.selectionStart).endsWith(o)&&(J=!1),!J){try{document.execCommand("ms-beginUndoUnit")}catch{}t.value=s+o+u;try{document.execCommand("ms-endUndoUnit")}catch{}t.dispatchEvent(new CustomEvent("input",{bubbles:!0,cancelable:!0}))}e!=null&&i!=null?t.setSelectionRange(e,i):t.setSelectionRange(n,t.selectionEnd)}function Vn(t,o){let e=t.value.slice(t.selectionStart,t.selectionEnd),i;o.orderedList||o.unorderedList?i=Rn(t,o):o.multiline&&Ye(e)?i=Nn(t,o):i=jn(t,o),An(t,i)}function zn(t){let o=t.value.split(`
`),e=0;for(let i=0;i<o.length;i++){let n=o[i].length+1;t.selectionStart>=e&&t.selectionStart<e+n&&(t.selectionStart=e),t.selectionEnd>=e&&t.selectionEnd<e+n&&(t.selectionEnd=e+n-1),e+=n}}function Bn(t,o,e,i=!1){if(t.selectionStart===t.selectionEnd)t.selectionStart=Pn(t.value,t.selectionStart),t.selectionEnd=Ln(t.value,t.selectionEnd,i);else{let n=t.selectionStart-o.length,s=t.selectionEnd+e.length,u=t.value.slice(n,t.selectionStart)===o,v=t.value.slice(t.selectionEnd,s)===e;u&&v&&(t.selectionStart=n,t.selectionEnd=s)}return t.value.slice(t.selectionStart,t.selectionEnd)}function Qe(t){let o=t.value.slice(0,t.selectionStart),e=t.value.slice(t.selectionEnd),i=o.match(/\n*$/),n=e.match(/^\n*/),s=i?i[0].length:0,u=n?n[0].length:0,v,_;return o.match(/\S/)&&s<2&&(v=zt(`
`,2-s)),e.match(/\S/)&&u<2&&(_=zt(`
`,2-u)),v==null&&(v=""),_==null&&(_=""),{newlinesToAppend:v,newlinesToPrepend:_}}function jn(t,o){let e,i,{prefix:n,suffix:s,blockPrefix:u,blockSuffix:v,replaceNext:_,prefixSpace:R,scanFor:E,surroundWithNewlines:ie}=o,$=t.selectionStart,ce=t.selectionEnd,F=t.value.slice(t.selectionStart,t.selectionEnd),b=Ye(F)&&u.length>0?`${u}
`:n,D=Ye(F)&&v.length>0?`
${v}`:s;if(R){let M=t.value[t.selectionStart-1];t.selectionStart!==0&&M!=null&&!M.match(/\s/)&&(b=` ${b}`)}F=Bn(t,b,D,o.multiline);let T=t.selectionStart,G=t.selectionEnd,Ht=_.length>0&&D.indexOf(_)>-1&&F.length>0;if(ie){let M=Qe(t);e=M.newlinesToAppend,i=M.newlinesToPrepend,b=e+n,D+=i}if(F.startsWith(b)&&F.endsWith(D)){let M=F.slice(b.length,F.length-D.length);if($===ce){let U=$-b.length;U=Math.max(U,T),U=Math.min(U,T+M.length),T=G=U}else G=T+M.length;return{text:M,selectionStart:T,selectionEnd:G}}else if(Ht)if(E.length>0&&F.match(E)){D=D.replace(_,F);let M=b+D;return T=G=T+b.length,{text:M,selectionStart:T,selectionEnd:G}}else{let M=b+F+D;return T=T+b.length+F.length+D.indexOf(_),G=T+_.length,{text:M,selectionStart:T,selectionEnd:G}}else{let M=b+F+D;T=$+b.length,G=ce+b.length;let U=F.match(/^\s*|\s*$/g);if(o.trimFirst&&U){let Je=U[0]||"",Ke=U[1]||"";M=Je+b+F.trim()+D+Ke,T+=Je.length,G-=Ke.length}return{text:M,selectionStart:T,selectionEnd:G}}}function Nn(t,o){let{prefix:e,suffix:i,surroundWithNewlines:n}=o,s=t.value.slice(t.selectionStart,t.selectionEnd),u=t.selectionStart,v=t.selectionEnd,_=s.split(`
`);if(_.every(E=>E.startsWith(e)&&E.endsWith(i)))s=_.map(E=>E.slice(e.length,E.length-i.length)).join(`
`),v=u+s.length;else if(s=_.map(E=>e+E+i).join(`
`),n){let{newlinesToAppend:E,newlinesToPrepend:ie}=Qe(t);u+=E.length,v=u+s.length,s=E+s+ie}return{text:s,selectionStart:u,selectionEnd:v}}function Bt(t){let o=t.split(`
`),e=/^\d+\.\s+/,i=o.every(s=>e.test(s)),n=o;return i&&(n=o.map(s=>s.replace(e,""))),{text:n.join(`
`),processed:i}}function jt(t){let o=t.split(`
`),e="- ",i=o.every(s=>s.startsWith(e)),n=o;return i&&(n=o.map(s=>s.slice(e.length,s.length))),{text:n.join(`
`),processed:i}}function de(t,o){return o?"- ":`${t+1}. `}function Wn(t,o){let e,i,n;return t.orderedList?(i=Bt(o),e=jt(i.text),n=e.text):(i=jt(o),e=Bt(i.text),n=e.text),[i,e,n]}function Rn(t,o){let e=t.selectionStart===t.selectionEnd,i=t.selectionStart,n=t.selectionEnd;zn(t);let s=t.value.slice(t.selectionStart,t.selectionEnd),[u,v,_]=Wn(o,s),R=_.split(`
`).map((b,D)=>`${de(D,o.unorderedList)}${b}`),E=R.reduce((b,D,T)=>b+de(T,o.unorderedList).length,0),ie=R.reduce((b,D,T)=>b+de(T,!o.unorderedList).length,0);if(u.processed)return e?(i=Math.max(i-de(0,o.unorderedList).length,0),n=i):(i=t.selectionStart,n=t.selectionEnd-E),{text:_,selectionStart:i,selectionEnd:n};let{newlinesToAppend:$,newlinesToPrepend:ce}=Qe(t),F=$+R.join(`
`)+ce;return e?(i=Math.max(i+de(0,o.unorderedList).length+$.length,0),n=i):v.processed?(i=Math.max(t.selectionStart+$.length,0),n=t.selectionEnd+$.length+E-ie):(i=Math.max(t.selectionStart+$.length,0),n=t.selectionEnd+$.length+E),{text:F,selectionStart:i,selectionEnd:n}}function qe(t,o){let e=t.closest("markdown-toolbar");if(!(e instanceof Ue))return;let n=Object.assign(Object.assign({},{prefix:"",suffix:"",blockPrefix:"",blockSuffix:"",multiline:!1,replaceNext:"",prefixSpace:!1,scanFor:"",surroundWithNewlines:!1,orderedList:!1,unorderedList:!1,trimFirst:!1}),o),s=e.field;s&&(s.focus(),Vn(s,n))}var Gn=["textarea"];function Hn(t,o){t&1&&p(0,"ng-icon",30)}function Un(t,o){if(t&1){let e=y();r(0,"div",3)(1,"div",5)(2,"div",6)(3,"markdown-toolbar",7)(4,"md-bold",8),p(5,"ng-icon",9),a(),r(6,"md-italic",10),p(7,"ng-icon",11),a(),r(8,"md-quote",12),p(9,"ng-icon",13),a(),r(10,"md-code",14),p(11,"ng-icon",15),a(),r(12,"md-link",16),p(13,"ng-icon",17),a(),r(14,"md-image",18),p(15,"ng-icon",19),a(),r(16,"md-unordered-list",20),p(17,"ng-icon",21),a(),r(18,"md-ordered-list",22),p(19,"ng-icon",23),a(),r(20,"md-task-list",24),p(21,"ng-icon",25),a(),r(22,"md-table",26),x("click",function(){C(e);let n=c(2);return w(n.insertTable())}),p(23,"ng-icon",27),a(),r(24,"md-preview")(25,"ng-icon",28),x("click",function(){C(e);let n=c(2);return w(n.onPreview())}),a()()(),r(26,"div",29),g(27,Hn,1,0,"ng-icon",30),a()(),p(28,"div",31),r(29,"textarea",32,0),x("focus",function(){C(e);let n=c(2);return w(n.onEdit())})("blur",function(){C(e);let n=c(2);return w(n.onBlur())}),d(31,"          "),a(),p(32,"div",33),r(33,"div",34)(34,"a",35),d(35,"Markdown is supported"),a()()()()}if(t&2){let e=c(2);l(),Y("focus",e.focus),l(2),et("for",e.controlId),l(2),m("size",e.iconSize),l(2),m("size",e.iconSize),l(2),m("size",e.iconSize),l(2),m("size",e.iconSize),l(2),m("size",e.iconSize),l(2),m("size",e.iconSize),l(2),m("size",e.iconSize),l(2),m("size",e.iconSize),l(2),m("size",e.iconSize),l(2),m("size",e.iconSize),l(2),m("size",e.iconSize),l(2),f(e.loading?27:-1),l(2),m("id",e.controlId)("formControl",e.control)}}function Yn(t,o){if(t&1){let e=y();r(0,"div",4),p(1,"markdown",36),r(2,"div",37),x("click",function(){C(e);let n=c(2);return w(n.onEdit())}),p(3,"ng-icon",38),a()()}if(t&2){let e=c(2);m("ngClass",e.previewClass),l(),m("data",e.control.value)}}function qn(t,o){if(t&1&&(r(0,"div",1),g(1,Un,36,17,"div",3)(2,Yn,4,2,"div",4),a()),t&2){let e=c();l(),f(e.preview?2:1)}}function Qn(t,o){if(t&1&&p(0,"markdown",2),t&2){let e=c();m("data",e.control.value)}}var Gt=(()=>{class t{controlId=`md-editor-${Math.floor(1e5*Math.random())}`;textarea;control=new ct("");previewClass="";set data(e){this.onChange(e),this.control.setValue(e)}dataChange=new P;editable=!0;row=2;preview=!1;previewChange=new P;loading=!1;focus=!1;iconSize="15";constructor(){}onChange=e=>{};onTouched=()=>{};ngOnInit(){}writeValue(e){this.control.setValue(e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){}onEdit(){this.preview=!1,this.previewChange.emit(!1),this.focus=!0}onBlur(){this.onChange(this.control.value),this.dataChange.emit(this.control.value),this.focus=!1}onPreview(){this.control.value&&(this.preview=!0,this.previewChange.emit(!0))}insertTable(){this.insertText(`
| header | header |
| ------ | ------ |
| cell | cell |
| cell | cell |
`)}insertText(e){var i=this.textarea.nativeElement.selectionStart;this.textarea.nativeElement.focus();let n=this.textarea.nativeElement.value.substr(0,this.textarea.nativeElement.selectionStart)+e+this.textarea.nativeElement.value.substr(this.textarea.nativeElement.selectionStart,this.textarea.nativeElement.value.length);this.control.setValue(n),this.textarea.nativeElement.selectionStart=i+e.length,this.textarea.nativeElement.selectionEnd=i+e.length}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["markdown-editor"]],viewQuery:function(i,n){if(i&1&&nt(Gn,5),i&2){let s;it(s=ot())&&(n.textarea=s.first)}},inputs:{previewClass:"previewClass",data:"data",editable:"editable",row:"row",preview:"preview",loading:"loading"},outputs:{dataChange:"dataChange",previewChange:"previewChange"},standalone:!0,features:[rt([bt()]),k],decls:2,vars:1,consts:[["textarea",""],[1,"w-full"],[1,"w-full",3,"data"],[1,"space-y-1"],[1,"preview",3,"ngClass"],[1,"editor"],[1,"flex","flex-row","justify-between","mt-2"],[1,"flex","flex-row","items-center","gap-2","cursor-pointer"],["title","Bold","aria-label","Bold"],["name","bold",3,"size"],["title","Italic","aria-label","Italic"],["name","italic",3,"size"],["title","Quote","aria-label","Quote"],["name","quote",3,"size"],["title","Code","aria-label","Code"],["name","codeBracket",3,"size"],["title","Link","aria-label","Link"],["name","link",3,"size"],["title","Image","aria-label","Image"],["name","media",3,"size"],["title","Unordered List","aria-label","Unordered List"],["name","listBullet",3,"size"],["title","Ordered List","aria-label","Ordered List"],["name","listNumber",3,"size"],["title","Task List","aria-label","Task List"],["name","listTask",3,"size"],["title","Table","aria-label","Table",3,"click"],["name","table",3,"size"],["name","eye",1,"cursor-pointer",3,"click","size"],[1,"flex","flex-row","items-center"],["name","spin",1,"animate-spin"],[1,"w-full","h-0.5","border-t","border-border"],[1,"overflow-y-auto","max-h-96",3,"focus","blur","id","formControl"],[1,"w-full","h-0.5","border-b","border-border"],[1,"w-full","flex","flex-row","space-x-1","items-center","justify-between","py-1"],["target","_blank","href","https://www.markdownguide.org/basic-syntax/",1,"hidden","md:block","no-wrap","text-xs"],[3,"data"],["title","Click to edit",1,"p-1","icon-edit","cursor-pointer",3,"click"],["name","heroPencilSquare",1,"text-primary"]],template:function(i,n){i&1&&g(0,qn,3,1,"div",1)(1,Qn,1,1,"markdown",2),i&2&&f(n.editable?0:1)},dependencies:[be,L,xe,ge,_e,pt,N],styles:["table[_ngcontent-%COMP%]{border-width:1px;--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity))}.ant-input[_ngcontent-%COMP%]:focus{border:none;box-shadow:none}.ant-input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]{border:none}textarea[_ngcontent-%COMP%]:focus{border:none}textarea[_ngcontent-%COMP%]:hover{border:none}markdown-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:baseline}markdown-toolbar[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;display:inline-block;height:24px;padding:3px 5px;width:28px;color:#222}markdown-toolbar[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{display:flex}markdown-toolbar[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:var(--primary-color)}.editor[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;border-width:1px;border-color:var(--border);background-color:var(--background);padding-left:.5rem;padding-right:.5rem;border-radius:3px}.editor[_ngcontent-%COMP%]   .text-editor[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px;resize:none;border-color:transparent;width:100%;overflow-y:hidden}.editor[_ngcontent-%COMP%]   .text-editor[_ngcontent-%COMP%]:focus{outline:none;border:transparent}.preview[_ngcontent-%COMP%]{position:relative;min-height:32px}.preview[_ngcontent-%COMP%]   .icon-edit[_ngcontent-%COMP%]{font-weight:400;display:none;position:absolute;right:3px;top:3px}.preview[_ngcontent-%COMP%]:hover{border-width:1px;border-color:var(--border);background-color:var(--background)}.preview[_ngcontent-%COMP%]:hover   .icon-edit[_ngcontent-%COMP%]{display:block}"]})}return t})();var Jn=()=>[],Kn=t=>["/project",t,"scan"],Xn=t=>["/finding",t];function Zn(t,o){if(t&1){let e=y();r(0,"div",15)(1,"a",38),p(2,"ng-icon",39),a(),p(3,"div",40),r(4,"ng-icon",41),x("click",function(){C(e);let n=c();return w(n.closeFinding())}),a()()}if(t&2){let e=c();l(),m("routerLink",$e(1,Xn,e.finding.id))}}function ei(t,o){t&1&&(r(0,"button",43),d(1,"Add Deadline"),a())}function ti(t,o){t&1&&(r(0,"div",44),d(1,"deadline"),a())}function ni(t,o){if(t&1){let e=y();r(0,"date-picker",42),x("dateChange",function(n){C(e);let s=c();return w(s.onChangeFixDeadline(n))}),a(),g(1,ei,2,0,"ng-template",null,0,le)(3,ti,2,0,"ng-template",null,1,le)}if(t&2){let e=ae(2),i=ae(4),n=c();m("titleTemplate",e)("afterDateTemplate",i)("date",n.fixDeadline())("format",n.dateFormat)}}function ii(t,o){if(t&1&&(r(0,"div",45)(1,"span"),d(2),W(3,"date"),a(),r(4,"div",44),d(5,"deadline"),a()()),t&2){let e=c(2);l(2),j(" ",Q(3,1,e.finding.fixDeadline,e.dateFormat)," ")}}function oi(t,o){if(t&1&&g(0,ii,6,4,"div",45),t&2){let e=c();f(e.finding.fixDeadline?0:-1)}}function ri(t,o){if(t&1){let e=y();r(0,"ticket-dropdown",46),x("onDelete",function(){C(e);let n=c();return w(n.deleteTicket())})("onTicket",function(n){C(e);let s=c();return w(s.createTicket(n))}),a()}if(t&2){let e=c();m("loading",e.loadingTicket)("ticket",e.ticket())}}function ai(t,o){if(t&1&&(r(0,"div",49)(1,"div"),d(2),a()()),t&2){let e=c(2);l(2),h(e.finding.location.snippet)}}function li(t,o){if(t&1&&(r(0,"div",21)(1,"div",22),d(2,"Found at"),a(),r(3,"a",47)(4,"span"),d(5),a(),p(6,"ng-icon",48),a(),g(7,ai,3,1,"div",49),a()),t&2){let e=c();l(3),m("href",e.source(e.finding.location),oe),l(2),h(e.finding.location.path),l(2),f(e.finding.location.snippet?7:-1)}}function si(t,o){if(t&1&&(r(0,"div",21)(1,"div",22),d(2,"Description"),a(),r(3,"div",49)(4,"div",50),d(5),a()()()),t&2){let e=c();l(5),h(e.finding.description)}}function di(t,o){if(t&1){let e=y();r(0,"div",52)(1,"button",53),x("click",function(){C(e);let n=c(2);return w(n.saveRecommendation())}),d(2,"Save"),a(),r(3,"button",35),x("click",function(){C(e);let n=c(2);return w(n.recommendationPreview=!0)}),d(4,"Cancel"),a()()}}function ci(t,o){if(t&1){let e=y();r(0,"markdown-editor",51),Re("dataChange",function(n){C(e);let s=c();return pe(s.finding.recommendation,n)||(s.finding.recommendation=n),w(n)})("previewChange",function(n){C(e);let s=c();return pe(s.recommendationPreview,n)||(s.recommendationPreview=n),w(n)}),a(),g(1,di,5,0,"div",52)}if(t&2){let e=c();We("data",e.finding.recommendation)("preview",e.recommendationPreview),m("loading",e.recommendationLoading),l(),f(e.recommendationPreview?-1:1)}}function mi(t,o){if(t&1){let e=y();r(0,"button",54),x("click",function(){C(e);let n=c();return w(n.recommendationPreview=!1)}),d(1,"Add Recommendation"),a()}}function pi(t,o){if(t&1&&(r(0,"li",56),d(1),a()),t&2){let e=o.$implicit;l(),h(e)}}function ui(t,o){if(t&1&&(r(0,"div",21)(1,"div",22),d(2,"CWEs"),a(),r(3,"ul",55),z(4,pi,2,1,"li",56,V),a()()),t&2){let e=c();l(4),B(e.finding.metadata.cwes)}}function fi(t,o){if(t&1&&(r(0,"li",57),d(1),a()),t&2){let e=o.$implicit;l(),h(e)}}function gi(t,o){if(t&1&&(r(0,"div",21)(1,"div",22),d(2,"References"),a(),r(3,"ul",55),z(4,fi,2,1,"li",57,V),a()()),t&2){let e=c();l(4),B(e.finding.metadata.references)}}function _i(t,o){t&1&&p(0,"div",60)}function xi(t,o){if(t&1&&(r(0,"a",59),d(1),a(),g(2,_i,1,0,"div",60)),t&2){let e=o.$implicit,i=o.$index,n=o.$count,s=c(2);m("href",s.source(e),oe),l(),j(" ",e.snippet," "),l(),f(i!==n-1?2:-1)}}function hi(t,o){if(t&1&&(r(0,"div",21)(1,"div",22),d(2,"Finding Flow"),a(),r(3,"div",58),z(4,xi,3,3,null,null,V),a()()),t&2){let e=c();l(4),B(e.findingFlow(e.finding))}}function vi(t,o){if(t&1&&p(0,"finding-activity",37),t&2){let e=o.$implicit;m("activity",e)}}var Er=(()=>{class t{findingService;toastr;close=new P;set finding(e){this._finding=e,this.ticket.set(e.ticket),this.fixDeadline.set(this.parseFixDeadline(e.fixDeadline)),this.currentScan=e.scans?.find(i=>i.isDefault),!this.currentScan&&e.scans&&e.scans.length>0&&(this.currentScan=e.scans[0]),e.id&&this.loadActivities()}dateFormat="dd/MM/yyyy";currentScan;activities=[];get finding(){return this._finding}_finding={project:{},scans:[]};minimal=!0;isProjectPage=!1;fixDeadline=re(null);ticket=re(void 0);comment="";commentLoading=!1;loadingTicket=!1;recommendationPreview=!0;recommendationLoading=!1;constructor(e,i){this.findingService=e,this.toastr=i}onChangeStatus(e){this.findingService.updateFinding({id:this.finding.id,body:{status:e}}).subscribe(i=>{this.finding=i,this.toastr.success("update success"),this.loadActivities()})}closeFinding(){this.close.emit()}getScreenSize(){this.isProjectPage||(this.minimal=window.innerWidth<1024)}findingFlow(e){return e.metadata&&e.metadata.findingFlow&&e.metadata.findingFlow.length>0?e.metadata.findingFlow:[]}source(e){return this._finding.project?.sourceType==wt.GitLab?`${this._finding.project.repoUrl}/-/blob/${this.currentScan?.commitHash}/${e.path}#L${e.startLine??"1"}`:""}onScanChange(e){this.currentScan=this.finding.scans?.find(i=>i.scanId==e)}loadActivities(){this.findingService.getFindingActivities({id:this._finding.id,body:{}}).subscribe(e=>{this.activities=e.items})}GitAction=te;FindingStatus=A;onChangeFixDeadline(e){let i=this.fixDeadline();this.fixDeadline.set(e),this.findingService.updateFinding({id:this._finding.id,body:{fixDeadline:e.toISOString()}}).subscribe({next:n=>{this.toastr.success("Change deadline success!"),this.finding=n,this.loadActivities()},error:()=>{this.fixDeadline.set(i)}})}parseFixDeadline(e){return e?new Date(e):null}postComment(){this.comment&&(this.commentLoading=!0,this.findingService.addComment({id:this.finding.id,body:{comment:this.comment}}).pipe(me(()=>this.commentLoading=!1)).subscribe(e=>{let i=[e];i.push(...this.activities),this.activities=i,this.comment="",this.toastr.success("Add comment success!")}))}createTicket(e){this.loadingTicket=!0,this.findingService.createTicket({id:this.finding.id,type:e}).pipe(me(()=>this.loadingTicket=!1)).subscribe(i=>{this.ticket.set(i)})}isSastFinding(){return this.finding?this.finding.type==se.Sast||this.finding.type==se.Secret:!1}deleteTicket(){this.findingService.deleteTicket({id:this.finding.id}).subscribe(()=>{this.ticket.set(void 0)})}saveRecommendation(){this.recommendationLoading=!0,this.findingService.updateFinding({id:this.finding.id,body:{recommendation:this.finding.recommendation}}).pipe(me(()=>this.recommendationLoading=!1)).subscribe(()=>{this.toastr.success("Update recommendation success!")})}static \u0275fac=function(i){return new(i||t)(K(gt),K(St))};static \u0275cmp=S({type:t,selectors:[["finding-detail"]],hostBindings:function(i,n){i&1&&x("resize",function(u){return n.getScreenSize(u)},!1,Ze)},inputs:{finding:"finding",minimal:"minimal",isProjectPage:"isProjectPage"},outputs:{close:"close"},standalone:!0,features:[k],decls:54,vars:28,consts:[["datePickerTitle",""],["afterDateTemplate",""],[1,"flex","flex-col","gap-4","w-full"],[1,"flex","flex-col","border-b","border-border","pb-4","gap-4"],[1,"flex","flex-row","items-center","w-full","gap-2"],[3,"severity"],[1,"text-xl"],[1,"flex","flex-row","items-center","justify-between"],[1,"flex","flex-row","items-center","gap-4"],[1,"flex","flex-wrap","items-center","gap-2"],[1,"font-semibold","whitespace-nowrap"],[3,"selectChange","options","selected"],[1,"flex","flex-row","gap-2","items-center"],[3,"name"],[1,"hover:underline",3,"routerLink"],[1,"flex-row","gap-2","items-center","hidden","lg:flex"],[1,"flex","flex-row","items-center","gap-2","text-xs"],[3,"statusChange","status"],[3,"loading","ticket"],[1,"flex","gap-4","w-full",3,"ngClass"],[1,"flex","flex-col","gap-4","w-full","border","border-border","p-4","h-fit"],[1,"flex","flex-col","gap-2"],[1,"font-semibold"],["app-button","","type","dashed"],[1,"flex","flex-col","gap-2",3,"ngClass"],[1,"flex","flex-col","rounded","border","border-border","p-4","gap-2"],[1,"flex","flex-col","overflow-y-auto","h-full","max-h-screen"],[1,"relative","border-s","border-border","ml-5"],[1,"mt-10","ms-6"],[1,"absolute","flex","items-center","justify-center","w-6","h-6","bg-blue-100","rounded-full","-start-3","dark:bg-blue-900"],["name","plusCircle","size","20"],[1,"flex","flex-row","items-center","justify-between","gap-2","mb-1"],[1,"flex","flex-col","w-full","gap-2"],[3,"ngModelChange","ngModel"],[1,"flex","flex-row","gap-2","items-center","justify-end"],["app-button","","type","default",3,"click"],["app-button","","type","primary",3,"click","loading","disabled"],[3,"activity"],[3,"routerLink"],["name","arrowsPointingOut","size","18",1,"cursor-pointer"],[1,"shrink-0","bg-border","w-[1px]","h-5","text-muted"],["name","x","size","18",1,"cursor-pointer",3,"click"],[3,"dateChange","titleTemplate","afterDateTemplate","date","format"],["app-button","","type","dashed",1,"border-primary"],[1,"text-white","bg-primary","rounded","px-1"],[1,"flex","flex-row","items-center","text-nowrap","gap-2","border","border-border","px-3","py-2","rounded-md","cursor-pointer"],[3,"onDelete","onTicket","loading","ticket"],["target","_blank",1,"flex","flex-row","items-center","gap-1",3,"href"],["name","arrowTopRightOnSquare"],[1,"block","rounded","border","border-border","bg-background","p-2","items-center"],["markdown",""],["previewClass","rounded border border-border bg-background p-2",3,"dataChange","previewChange","data","preview","loading"],[1,"flex","flex-row","items-center","gap-2"],["app-button","","type","primary",3,"click"],["app-button","","type","dashed",3,"click"],[1,"list-disc"],[1,"ml-4"],["markdown","",1,"ml-4"],[1,"flex","flex-col","justify-between","items-center"],["target","_blank",1,"flex","items-center","justify-center","bg-blue-100","px-2","py-1","dark:bg-blue-900","cursor-pointer",3,"href"],[1,"bg-primary","w-0.5","h-10"]],template:function(i,n){if(i&1&&(r(0,"div",2)(1,"div",3)(2,"div",4),p(3,"finding-severity",5),r(4,"div",6),d(5),a()(),r(6,"div",7)(7,"div",8)(8,"div",9)(9,"span",10),d(10),a(),r(11,"finding-scan-dropdown",11),x("selectChange",function(u){return n.onScanChange(u)}),a()(),r(12,"div",12),p(13,"ng-icon",13),W(14,"lowercase"),r(15,"a",14),d(16),a()()(),g(17,Zn,5,3,"div",15),a(),r(18,"div",16)(19,"finding-status",17),x("statusChange",function(u){return n.onChangeStatus(u)}),a(),g(20,ni,5,4)(21,oi,1,1)(22,ri,1,2,"ticket-dropdown",18),a()(),r(23,"div",19)(24,"div",20),g(25,li,8,3,"div",21)(26,si,6,1,"div",21),r(27,"div",21)(28,"div",22),d(29,"Recommendation"),a(),g(30,ci,2,4)(31,mi,2,0,"button",23),a(),g(32,ui,6,0,"div",21)(33,gi,6,0,"div",21)(34,hi,6,0,"div",21),a(),r(35,"div",24)(36,"div",25)(37,"div",22),d(38,"Activity"),a(),r(39,"div",26)(40,"ol",27)(41,"li",28)(42,"span",29),p(43,"ng-icon",30),a(),r(44,"div",31)(45,"div",32)(46,"textarea",33),Re("ngModelChange",function(u){return pe(n.comment,u)||(n.comment=u),u}),a(),r(47,"div",34)(48,"button",35),x("click",function(){return n.comment=""}),d(49,"Cancel"),a(),r(50,"button",36),x("click",function(){return n.postComment()}),d(51,"Comment "),a()()()()(),z(52,vi,1,1,"finding-activity",37,V),a()()()()()()),i&2){let s;l(3),m("severity",n.finding.severity),l(2),h(n.finding.name),l(5),j("On ",n.finding.scans==null?null:n.finding.scans.length," branch"),l(),m("options",(s=n.finding.scans)!==null&&s!==void 0?s:at(25,Jn))("selected",n.currentScan==null?null:n.currentScan.scanId),l(2),m("name",X(14,23,n.finding.project==null?null:n.finding.project.sourceType)),l(2),m("routerLink",$e(26,Kn,n.finding.project==null?null:n.finding.project.id)),l(),h(n.finding.project==null?null:n.finding.project.name),l(),f(n.minimal?17:-1),l(2),m("status",n.finding.status),l(),f(n.finding.status==n.FindingStatus.Confirmed?20:21),l(2),f(n.isSastFinding()?22:-1),l(),m("ngClass",n.minimal?"flex-col":"flex-row"),l(2),f(n.finding.location?25:-1),l(),f(n.finding.description?26:-1),l(4),f(n.finding.recommendation||!n.recommendationPreview?30:31),l(2),f(n.finding.metadata&&n.finding.metadata.cwes?32:-1),l(),f(n.finding.metadata&&n.finding.metadata.references?33:-1),l(),f(n.findingFlow(n.finding).length>0?34:-1),l(),m("ngClass",n.minimal?"":"min-w-[550px] max-w-[600px]"),l(11),We("ngModel",n.comment),l(4),m("loading",n.commentLoading)("disabled",n.commentLoading),l(2),B(n.activities)}},dependencies:[L,kt,fe,N,he,ue,be,Et,Ft,ft,Z,Dt,Mt,xe,ge,_e,ee,mt,Ot,Gt]})}return t})();export{kt as a,Tt as b,Ft as c,Ai as d,Er as e};
