import{a as J}from"./chunk-PJ57YFKH.js";import"./chunk-G3Z376R7.js";import"./chunk-VI62OPHC.js";import"./chunk-JFWL3IR4.js";import"./chunk-NJ6R6LRK.js";import"./chunk-RLVYGCTC.js";import"./chunk-2AZPC3K3.js";import"./chunk-7JDTD5PV.js";import"./chunk-G46RF4U2.js";import{a as ae}from"./chunk-YHE4N465.js";import"./chunk-KJV7B77S.js";import{a as oe}from"./chunk-QXA7VEUO.js";import{g as h,i as I,j as y}from"./chunk-ZSGDYSVW.js";import{a as w}from"./chunk-CEX33KBR.js";import{b as ie,c as x}from"./chunk-ZEESFLET.js";import"./chunk-7ICDGKY7.js";import"./chunk-ENGL65RD.js";import{a as re}from"./chunk-W4N5Z7QK.js";import"./chunk-32FVIJUL.js";import{d as H,f as U}from"./chunk-2IXFTJ2H.js";import{a as K,b as X}from"./chunk-UHSV32VQ.js";import{b as Y,d as Z,i as ee,q as te,r as ne}from"./chunk-5ASYMZAG.js";import"./chunk-PHZ4YKFG.js";import"./chunk-T2ZIFUV5.js";import"./chunk-KENT5INO.js";import{e as S}from"./chunk-FHVUNOKG.js";import{m as G}from"./chunk-3OH2LOAZ.js";import{H as j,Ib as _,Jb as z,Kb as D,Mb as V,Nb as A,Ob as W,P as R,Q as L,Qb as b,R as T,Sa as a,Ta as v,Ub as Q,V as E,Vb as q,Za as C,ba as k,db as m,f as P,fb as f,kb as d,la as F,lb as B,ma as M,nb as N,ob as $,pb as o,qb as r,rb as l,tb as O,wb as u,xb as g}from"./chunk-LUMD5QXA.js";import"./chunk-AIZVJUQQ.js";function pe(e,c){e&1&&l(0,"ng-icon",5)}function me(e,c){e&1&&l(0,"ng-icon",6)}function de(e,c){if(e&1&&m(0,pe,1,0,"ng-icon",5)(1,me,1,0,"ng-icon",6),e&2){let t=g();d(t.impact==t.RiskImpact.Indirect?0:1)}}function fe(e,c){e&1&&l(0,"ng-icon",1)}function ge(e,c){e&1&&l(0,"ng-icon",2)}function ue(e,c){e&1&&l(0,"ng-icon",3)}function _e(e,c){e&1&&l(0,"ng-icon",4)}var ce=(()=>{class e{risk=y.None;impact=I.None;RiskLevel=y;RiskImpact=I;static \u0275fac=function(i){return new(i||e)};static \u0275cmp=k({type:e,selectors:[["risk-level-icon"]],inputs:{risk:"risk",impact:"impact"},standalone:!0,features:[b],decls:7,vars:4,consts:[[1,"px-1",3,"tooltip"],["name","shield-exclamation",1,"text-low"],["name","shield-exclamation",1,"text-medium"],["name","shield-exclamation",1,"text-high"],["name","shield-exclamation",1,"text-critical"],["name","shield-exclamation",1,"text-green-500"],["name","shieldCheck",1,"text-green-500"]],template:function(i,n){if(i&1&&(o(0,"div",0),Q(1,"lowercase"),m(2,de,2,1)(3,fe,1,0,"ng-icon",1)(4,ge,1,0,"ng-icon",2)(5,ue,1,0,"ng-icon",3)(6,_e,1,0,"ng-icon",4),r()),i&2){let s;f("tooltip",q(1,2,n.risk)),a(2),d((s=n.risk)===n.RiskLevel.None?2:s===n.RiskLevel.Low?3:s===n.RiskLevel.Medium?4:s===n.RiskLevel.High?5:s===n.RiskLevel.Critical?6:-1)}},dependencies:[S,w,G]})}return e})();var se=(()=>{class e{loading=C(!1);currentPage=C(0);totalPage=C(0);dependencies=C([]);filter={desc:!0,name:"",page:1,size:20,sortBy:h.RiskLevel};static \u0275fac=function(i){return new(i||e)};static \u0275prov=E({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Ce(e,c){if(e&1&&(o(0,"span",27),_(1,"fixed version"),r(),o(2,"div",28),_(3),r()),e&2){let t=g().$implicit;a(3),D(" ",t.fixedVersion," ")}}function xe(e,c){if(e&1){let t=O();o(0,"div",19),l(1,"risk-level-icon",20),o(2,"div",21),u("click",function(){let n=F(t).$implicit,s=g(2);return M(s.onOpenDependency(n.id))}),o(3,"div",22)(4,"div",3)(5,"div",23),_(6),r(),l(7,"ng-icon",24),r(),o(8,"div",25)(9,"div",26)(10,"span"),_(11),r()(),o(12,"div",3),m(13,Ce,4,1),r()()()()()}if(e&2){let t,i=c.$implicit,n=g(2);a(),f("risk",i.riskLevel)("impact",i.riskImpact),a(5),D(" ",n.getNameDependency(i)," "),a(),f("name",(t=i.type)!==null&&t!==void 0?t:"unknown")("tooltip",i.type),a(4),z(i.location),a(2),d(i.fixedVersion?13:-1)}}function he(e,c){if(e&1&&(o(0,"tbody"),N(1,xe,14,7,"div",19,B),r()),e&2){let t=g();a(),$(t.store.dependencies())}}function ye(e,c){e&1&&l(0,"loading-table")}function ke(e,c){e&1&&l(0,"coming-soon")}function be(e,c){e&1&&l(0,"ng-icon",29)}function Se(e,c){e&1&&(l(0,"ng-icon",30),o(1,"div"),_(2,"Select dependency to see its details."),r())}function we(e,c){if(e&1&&(o(0,"div",18),m(1,be,1,0,"ng-icon",29)(2,Se,3,0),r()),e&2){let t=g();a(),d(t.loadingDependency?1:2)}}var lt=(()=>{class e{projectService;projectStore;store;router;route;destroy$=new P;loadingDependency=!1;dependency=!1;constructor(t,i,n,s,p){this.projectService=t,this.projectStore=i,this.store=n,this.router=s,this.route=p}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}ngOnInit(){this.projectService.getProjectPackages({projectId:this.projectStore.projectId(),body:this.store.filter}),this.route.queryParams.pipe(R(t=>(ie(t,this.store.filter),this.getProjectDependencies())),L(this.destroy$)).subscribe()}onSearchChange(){x(this.router,this.store.filter)}onReload(){this.getProjectDependencies().subscribe()}getProjectDependencies(){return this.store.loading.set(!0),this.projectService.getProjectPackages({projectId:this.projectStore.projectId(),body:this.store.filter}).pipe(j(()=>this.store.loading.set(!1)),T(t=>{this.store.dependencies.set(t.items),this.store.currentPage.set(t.currentPage),this.store.totalPage.set(t.pageCount)}))}onPageChange(t){this.store.filter.page=t,x(this.router,this.store.filter)}onOpenDependency(t){this.dependency=!0}getNameDependency(t){return t.group?`${t.group}.${t.name}@${t.version}`:`${t.name}@${t.version}`}RiskLevel=y;sortOptions=[{label:"Name",value:h.Name},{label:"Impact",value:h.RiskLevel}];onSortChange(t){this.store.filter.sortBy=t,x(this.router,this.store.filter)}onOrderChange(){this.store.filter.desc=!this.store.filter.desc,x(this.router,this.store.filter)}static \u0275fac=function(i){return new(i||e)(v(re),v(ae),v(se),v(U),v(H))};static \u0275cmp=k({type:e,selectors:[["app-dependency"]],standalone:!0,features:[b],decls:23,vars:10,consts:[[1,"mx-auto","px-2","lg:px-6","flex","flex-row","pt-6","text-sm","gap-4","w-full"],[1,"flex","flex-col","w-full"],[1,"flex","flex-wrap","w-full","p-4","gap-2","items-center","justify-between","border-border","border","bg-background"],[1,"flex","flex-row","items-center","gap-2"],[1,"flex","w-full","md:max-w-80"],[1,"relative","text-muted-foreground","w-full"],[1,"absolute","left-2.5","top-2.5"],["name","heroMagnifyingGlass"],["placeholder","Search...","type","text",1,"py-2","pl-8","pr-2",3,"ngModelChange","keyup.enter","ngModel"],[1,"flex","flex-row","gap-2","items-center"],[3,"selectedChange","options","showSearch","selected"],["dropdown-label","",1,"font-semibold"],["size","16",1,"cursor-pointer",3,"click","name"],[1,"flex","items-center","cursor-pointer","px-4","py-2","rounded","bg-background","border","border-border",3,"click"],["name","arrowPath"],[1,"table","w-full","table-auto","border-collapse","border-0","text-left","align-middle","leading-5","text-muted-foreground"],[1,"sticky","bottom-0",3,"pageChange","currentPage","totalPage"],[1,"hidden","lg:block","w-[800px]","overflow-x-auto"],[1,"flex","flex-col","items-center","justify-center","h-[720px]","w-full"],[1,"flex","flex-row","items-center","gap-3","p-4","bg-background","border-b","border-border","hover:bg-card"],[1,"text-xl",3,"risk","impact"],[1,"flex","flex-row","items-center","gap-3","cursor-pointer","w-full",3,"click"],[1,"flex","flex-col","gap-1","w-full"],[1,"font-semibold"],["size","18",3,"name","tooltip"],[1,"flex","flex-row","items-center","justify-between","w-full"],[1,"flex","flex-row","items-center","gap-1"],[1,"lowercase"],[1,"text-xs","border","border-border","px-2","py-0.5","rounded-lg","w-fit","text-[#0B5CAD]","bg-[#CBE2F9]","dark:bg-[#0B5CAD]","dark:text-[#CBE2F9]"],["name","spin","size","24",1,"animate-spin"],["name","cursorArrowRays","size","24"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5)(6,"div",6),l(7,"ng-icon",7),r(),o(8,"input",8),W("ngModelChange",function(p){return A(n.store.filter.name,p)||(n.store.filter.name=p),p}),u("keyup.enter",function(){return n.onSearchChange()}),r()()(),o(9,"div",9)(10,"dropdown",10),u("selectedChange",function(p){return n.onSortChange(p)}),o(11,"div",11),_(12,"Sort By"),r()(),o(13,"ng-icon",12),u("click",function(){return n.onOrderChange()}),r()(),o(14,"div",13),u("click",function(){return n.onReload()}),l(15,"ng-icon",14),r()()(),o(16,"table",15),m(17,he,3,0,"tbody"),r(),m(18,ye,1,0,"loading-table"),o(19,"pagination",16),u("pageChange",function(p){return n.onPageChange(p)}),r()(),o(20,"div",17),m(21,ke,1,0,"coming-soon")(22,we,3,1,"div",18),r()()),i&2&&(a(8),V("ngModel",n.store.filter.name),a(2),f("options",n.sortOptions)("showSearch",!1)("selected",n.store.filter.sortBy),a(3),f("name",n.store.filter.desc?"desc":"asc"),a(4),d(n.store.loading()?-1:17),a(),d(n.store.loading()?18:-1),a(),f("currentPage",n.store.currentPage())("totalPage",n.store.totalPage()),a(2),d(n.dependency?21:22))},dependencies:[J,S,X,ne,Y,Z,te,ee,K,ce,w,oe]})}return e})();export{lt as DependencyComponent};
