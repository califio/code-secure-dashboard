import{a as q}from"./chunk-YPCCXZX6.js";import{a as G}from"./chunk-JFWL3IR4.js";import{da as H}from"./chunk-G46RF4U2.js";import{a as U}from"./chunk-CEX33KBR.js";import{a as K}from"./chunk-ENGL65RD.js";import{a as j}from"./chunk-UHSV32VQ.js";import{b as B,d as L,i as W,q as O,r as R}from"./chunk-5ASYMZAG.js";import{a as $,b as z}from"./chunk-PHZ4YKFG.js";import"./chunk-T2ZIFUV5.js";import"./chunk-KENT5INO.js";import{e as V}from"./chunk-FHVUNOKG.js";import"./chunk-3OH2LOAZ.js";import{H as v,Ib as r,Jb as h,Kb as b,Mb as F,Nb as D,Ob as N,Qb as M,Sa as l,Ta as T,Ub as A,Vb as P,ba as g,db as s,fb as f,hb as w,kb as u,la as C,lb as S,ma as x,nb as y,ob as E,pb as n,qb as t,rb as p,tb as I,wb as c,xb as k}from"./chunk-LUMD5QXA.js";import"./chunk-AIZVJUQQ.js";function J(o,d){o&1&&(n(0,"span",24),r(1,"***********************"),t())}function Q(o,d){if(o&1&&(n(0,"span",24),r(1),t()),o&2){let e=k().$implicit;l(),h(e.token.value)}}function X(o,d){if(o&1){let e=I();n(0,"tr")(1,"td",21),p(2,"input",22),t(),n(3,"td")(4,"span",23),r(5),t()(),n(6,"td")(7,"div",10),s(8,J,2,0,"span",24)(9,Q,2,1,"span",24),n(10,"div",25)(11,"ng-icon",26),c("click",function(){let i=C(e).$implicit;return x(i.hidden=!i.hidden)}),t()()()(),n(12,"td")(13,"div",27)(14,"span",28),r(15),A(16,"timeago"),t()()(),n(17,"td")(18,"div",29),c("click",function(){let i=C(e).$implicit,m=k(2);return x(m.onDeleteToken(i.token.id))}),p(19,"ng-icon",30),t()()()}if(o&2){let e=d.$implicit;l(5),h(e.token.name),l(3),u(e.hidden?8:9),l(3),f("name",e.hidden?"eyeSlash":"eye"),l(3),f("tooltip",e.token.createdAt),l(),b(" ",P(16,5,e.token.createdAt)," ")}}function Y(o,d){if(o&1&&(n(0,"tbody"),y(1,X,20,7,"tr",null,S),t()),o&2){let e=k();l(),E(e.tokens)}}function Z(o,d){o&1&&p(0,"loading-table")}var ke=(()=>{class o{tokenService;toastr;loading=!1;tokens=[];enableCreateTokenForm=!1;tokenName="";showConfirmPopup=!1;constructor(e,a){this.tokenService=e,this.toastr=a,this.tokenService.getCiTokens().subscribe(i=>{this.tokens=i.map(m=>({hidden:!0,token:m}))})}createCIToken(){this.tokenName.trim()?this.tokenService.createCiToken({body:{name:this.tokenName.trim()}}).subscribe(e=>{this.tokens=[{hidden:!0,token:e}].concat(...this.tokens),this.toastr.success("create success"),this.enableCreateTokenForm=!1}):this.toastr.warning("token name is blank")}copyTokenValue(e){navigator.clipboard.writeText(e),this.toastr.success("copy CI token success")}confirmDelete(){this.deleteTokenId&&this.tokenService.deleteCiToken({id:this.deleteTokenId}).pipe(v(()=>{this.showConfirmPopup=!1})).subscribe(e=>{e&&(this.toastr.success("Delete success"),this.tokens=this.tokens.filter(a=>a.token.id!=this.deleteTokenId))})}onDeleteToken(e){this.deleteTokenId=e,this.showConfirmPopup=!0}deleteTokenId=null;static \u0275fac=function(a){return new(a||o)(T(q),T(H))};static \u0275cmp=g({type:o,selectors:[["app-ci-token"]],standalone:!0,features:[M],decls:37,vars:7,consts:[[1,"mx-auto","px-2","lg:px-6","flex","flex-col","pt-6","text-sm"],[1,"font-semibold","text-foreground","mb-2","ml-1","text-xl"],[1,"flex","min-w-full","flex-col","rounded-xl","border","border-border","bg-background","gap-2"],[1,"flex","flex-row","items-center","justify-between","py-1","px-5"],[1,"px-1","py-1","whitespace-nowrap"],[1,"flex","flex-row","w-fit","pt-4"],["app-button","","type","primary",3,"click"],[1,"flex","flex-col","w-full","border","border-border","gap-2","p-4"],[1,"text-base"],["type","text",1,"max-w-72","py-2",3,"ngModelChange","ngModel"],[1,"flex","flex-row","items-center","gap-2"],["app-button","","type","default",3,"click"],[1,"overflow-x-auto"],[1,"table","w-full","table-auto","border-collapse","border-0","text-left","align-middle","leading-5","text-muted-foreground"],[1,"border-t","border-border","text-xs","text-muted-foreground"],[1,"w-[50px]","min-w-[50px]","text-center"],["data-datatable-check","true","type","checkbox",1,"checkbox","checkbox-sm"],[1,"min-w-[300px]"],[1,"min-w-[180px]"],[1,"flex","flex-row","justify-center"],[3,"cancel","confirm","hidden"],[1,"text-center"],["data-datatable-row-check","true","type","checkbox","value","28",1,"checkbox","checkbox-sm"],[1,"w-full"],[1,"w-fit"],[1,"p-1","cursor-pointer"],[3,"click","name"],[1,"font-semibold","text-[#00c869]"],[3,"tooltip"],[1,"flex","flex-row","p-2","cursor-pointer","w-full","justify-center",3,"click"],["name","trash"]],template:function(a,i){a&1&&(n(0,"div",0)(1,"div",1),r(2,"CI Access Token"),t(),n(3,"div",2)(4,"div",3)(5,"div",4),r(6),t(),n(7,"div",5)(8,"button",6),c("click",function(){return i.enableCreateTokenForm=!0}),r(9,"Add CI Token"),t()()(),n(10,"div",7)(11,"div",8),r(12,"Add a CI Token"),t(),n(13,"input",9),N("ngModelChange",function(_){return D(i.tokenName,_)||(i.tokenName=_),_}),t(),n(14,"div",10)(15,"button",6),c("click",function(){return i.createCIToken()}),r(16,"Create CI Token"),t(),n(17,"button",11),c("click",function(){return i.enableCreateTokenForm=!1,i.tokenName=""}),r(18,"Cancel"),t()()(),n(19,"div",12)(20,"table",13)(21,"thead",14)(22,"tr")(23,"th",15),p(24,"input",16),t(),n(25,"th",17),r(26,"TOKEN"),t(),n(27,"th",18),r(28,"VALUE"),t(),n(29,"th",18),r(30,"CREATED AT"),t(),n(31,"th",19)(32,"div"),r(33,"ACTION"),t()()()(),s(34,Y,3,0,"tbody"),t()(),s(35,Z,1,0,"loading-table"),t()(),n(36,"confirm-popup",20),c("cancel",function(){return i.showConfirmPopup=!1})("confirm",function(){return i.confirmDelete()}),t()),a&2&&(l(6),b("Displaying ",i.tokens.length," results"),l(4),w("hidden",!i.enableCreateTokenForm),l(3),F("ngModel",i.tokenName),l(21),u(i.loading?-1:34),l(),u(i.loading?35:-1),l(),f("hidden",!i.showConfirmPopup))},dependencies:[j,V,R,B,L,z,$,O,W,G,U,K]})}return o})();export{ke as CiTokenComponent};
