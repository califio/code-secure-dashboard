import {Component, input} from '@angular/core';
import {PackageTypeComponent} from '../package-type/package-type.component';
import {RiskLevelIconComponent} from '../../risk-level-icon/risk-level-icon.component';
import {TableModule} from 'primeng/table';
import {Vulnerabilities} from '../../../../api/models/vulnerabilities';
import {Checkbox} from 'primeng/checkbox';
import {FindingSeverityComponent} from '../../finding/finding-severity/finding-severity.component';
import {FindingStatusLabelComponent} from '../../finding/finding-status-label/finding-status-label.component';

@Component({
  selector: 'list-vulnerability',
  imports: [
    PackageTypeComponent,
    RiskLevelIconComponent,
    TableModule,
    Checkbox,
    FindingSeverityComponent,
    FindingStatusLabelComponent
  ],
  templateUrl: './list-vulnerability.component.html',
  standalone: true
})
export class ListVulnerabilityComponent {
  vulnerabilities = input([], {transform: transformVulnerabilities});
  typedVulnerability(vulnerability: Vulnerabilities): Vulnerabilities {
    return vulnerability;
  }
}

function transformVulnerabilities(input: Vulnerabilities[] | undefined | null): Vulnerabilities[] {
  if (!input) {
    return [];
  }
  return input;
}
