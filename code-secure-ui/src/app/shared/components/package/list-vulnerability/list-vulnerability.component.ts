import {Component, input} from '@angular/core';
import {TableModule} from 'primeng/table';
import {Vulnerabilities} from '../../../../api/models/vulnerabilities';
import {FindingSeverityComponent} from '../../finding/finding-severity/finding-severity.component';

@Component({
  selector: 'list-vulnerability',
  imports: [
    TableModule,
    FindingSeverityComponent,
  ],
  templateUrl: './list-vulnerability.component.html',
  standalone: true
})
export class ListVulnerabilityComponent {
  vulnerabilities = input([], {transform: transformVulnerabilities});

  typedVulnerability(vulnerability: Vulnerabilities): Vulnerabilities {
    return vulnerability;
  }
}

function transformVulnerabilities(input: Vulnerabilities[] | undefined | null): Vulnerabilities[] {
  if (!input) {
    return [];
  }
  return input;
}
